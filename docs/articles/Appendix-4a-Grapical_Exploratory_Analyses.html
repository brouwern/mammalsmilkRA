<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Appendix 4a: Graphical Exploratory Analysis • mammalsmilkRA</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Appendix 4a: Graphical Exploratory Analysis">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mammalsmilkRA</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Appendix-4a-Grapical_Exploratory_Analyses.html">Appendix 4a: Graphical Exploratory Analysis</a>
    </li>
    <li>
      <a href="../articles/Appendix-4b-Numeric_Exploratory_Analyses.html">Appendix 4b: Numeric Summaries &amp; Exploratory Analysis</a>
    </li>
    <li>
      <a href="../articles/Appendix-5-study_diagram.html">Appendix 5: Study Diagrams</a>
    </li>
    <li>
      <a href="../articles/Appendix-6a-Analysis-script.html">Analysis</a>
    </li>
    <li>
      <a href="../articles/Appendix-6b-Model-diagnostics-and-outliers.html">Appendix 6b: Model diagnostics</a>
    </li>
    <li>
      <a href="../articles/f-faq.html">f) Frequently asked questions</a>
    </li>
    <li>
      <a href="../articles/r-references.html">r) References</a>
    </li>
    <li>
      <a href="../articles/results-model-equation.html">Results - model equation</a>
    </li>
    <li>
      <a href="../articles/y-build_and_rebuild_package.html">z) Building and rebuilding vignettes</a>
    </li>
    <li>
      <a href="../articles/z-creating_the_package.html">z) Creating this package</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Appendix 4a: Graphical Exploratory Analysis</h1>
                        <h4 class="author">Nathan Brouwer | <a href="mailto:brouwern@gmail.com">brouwern@gmail.com</a> | <span class="citation">@lobrowR</span>
</h4>
            
            <h4 class="date">2018-11-30</h4>
      
      
      <div class="hidden name"><code>Appendix-4a-Grapical_Exploratory_Analyses.Rmd</code></div>

    </div>

    
    
<div id="preliminaries" class="section level2">
<h2 class="hasAnchor">
<a href="#preliminaries" class="anchor"></a>Preliminaries</h2>
<div id="load-packages" class="section level3">
<h3 class="hasAnchor">
<a href="#load-packages" class="anchor"></a>Load packages</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)  <span class="co"># for exploratory analyses</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'dplyr'</span>
<span class="co">#&gt; The following objects are masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     filter, lag</span>
<span class="co">#&gt; The following objects are masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     intersect, setdiff, setequal, union</span>
<span class="kw">library</span>(ggpubr) <span class="co"># plotting using ggplto2</span>
<span class="co">#&gt; Loading required package: ggplot2</span>
<span class="co">#&gt; Loading required package: magrittr</span>
<span class="kw">library</span>(cowplot)
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'cowplot'</span>
<span class="co">#&gt; The following object is masked from 'package:ggpubr':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     get_legend</span>
<span class="co">#&gt; The following object is masked from 'package:ggplot2':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     ggsave</span>
<span class="kw">library</span>(lme4)
<span class="co">#&gt; Loading required package: Matrix</span>
<span class="kw">library</span>(arm)
<span class="co">#&gt; Loading required package: MASS</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'MASS'</span>
<span class="co">#&gt; The following object is masked from 'package:dplyr':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     select</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; arm (Version 1.10-1, built: 2018-4-12)</span>
<span class="co">#&gt; Working directory is C:/Users/lisanjie/Documents/1_R/git/mammalsmilkRA/vignettes</span>
<span class="kw">library</span>(stringr) 
<span class="kw">library</span>(bbmle)
<span class="co">#&gt; Loading required package: stats4</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'bbmle'</span>
<span class="co">#&gt; The following object is masked from 'package:dplyr':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     slice</span>
<span class="kw">library</span>(plotrix) ##std.error function for SE
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'plotrix'</span>
<span class="co">#&gt; The following object is masked from 'package:arm':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     rescale</span>
<span class="kw">library</span>(psych)
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'psych'</span>
<span class="co">#&gt; The following object is masked from 'package:plotrix':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     rescale</span>
<span class="co">#&gt; The following objects are masked from 'package:arm':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     logit, rescale, sim</span>
<span class="co">#&gt; The following objects are masked from 'package:ggplot2':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     %+%, alpha</span>
<span class="kw">library</span>(here)
<span class="co">#&gt; here() starts at C:/Users/lisanjie/Documents/1_R/git/mammalsmilkRA</span></code></pre></div>
</div>
<div id="load-data" class="section level3">
<h3 class="hasAnchor">
<a href="#load-data" class="anchor"></a>Load data</h3>
<p>(Note: original files is called “skibiel_mammalsmilk.csv” within the mammalsmilk package. The data has been duplicated here but given a new name (“Appendix-2-Analysis-Data_mammalsmilkRA.csv”) to make this a stand-alone analysis compendium)</p>
<div id="load-data-in-r" class="section level4">
<h4 class="hasAnchor">
<a href="#load-data-in-r" class="anchor"></a>Load data in R</h4>
<p>If you have installed the mammalsmilkRA package the .csv “Appendix-2-Analysis-Data_mammalsmilkRA.csv” will be saved in the mammalsmilkRA directory R created to store package-related files. You can locate where this file is by searching for the file in your file system (eg “File explorer” in Windows) and then either setting its locations as your working dirctory or saving the file to a more convienent locations.</p>
<p>Alternatively, you load it directly from the mammalsmilkRA package; most anlyses aren’t packaged into in a package, so this is a unique short cut I’ve set upt.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">"milk"</span>)
<span class="co">#&gt; Warning in data("milk"): data set 'milk' not found</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">list.files</span>(<span class="kw">here</span>(<span class="st">"/inst/extdata"</span>))
<span class="co">#&gt; [1] "_original_files"                                       </span>
<span class="co">#&gt; [2] "analysis_comendium"                                    </span>
<span class="co">#&gt; [3] "Appendix-1-Raw-Data_Skibiel_et_al_2014_mammalsmilk.csv"</span>
<span class="co">#&gt; [4] "Appendix-2-Analysis-Data_mammalsmilkRA.csv"            </span>
<span class="co">#&gt; [5] "Appendix-3-Data-dictionary_mammalsmilkRA.xlsx"</span>
file. &lt;-<span class="st"> "Appendix-2-Analysis-Data_mammalsmilkRA.csv"</span>
path. &lt;-<span class="st"> </span>here<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/here/topics/here">here</a></span>(<span class="st">"/inst/extdata"</span>,file.)

milk &lt;-<span class="st"> </span><span class="kw">read.csv</span>(path., <span class="dt">skip =</span> <span class="dv">3</span>)</code></pre></div>
</div>
<div id="check-input" class="section level4">
<h4 class="hasAnchor">
<a href="#check-input" class="anchor"></a>Check input</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(milk)
<span class="co">#&gt;            ord     fam                            spp mass.fem gest.mo</span>
<span class="co">#&gt; 1 Artiodactyla Bovidae                  Bos frontalis   800000    9.02</span>
<span class="co">#&gt; 2 Artiodactyla Bovidae                     Capra ibex    53000    5.60</span>
<span class="co">#&gt; 3 Artiodactyla Bovidae Connocheates taurinus taurinus   170500    8.32</span>
<span class="co">#&gt; 4 Artiodactyla Bovidae              Connocheates gnou   200000    8.50</span>
<span class="co">#&gt; 5 Artiodactyla Bovidae  Damaliscus pygargus phillipsi    61000    8.00</span>
<span class="co">#&gt; 6 Artiodactyla Bovidae                 Gazella dorcas    20600    4.74</span>
<span class="co">#&gt;   lac.mo mass.litter repro.output dev.birth      diet arid       biome  N</span>
<span class="co">#&gt; 1    4.5       26949         0.03         3 herbivore   no terrestrial 4+</span>
<span class="co">#&gt; 2    7.5        3489         0.07         3 herbivore   no terrestrial 24</span>
<span class="co">#&gt; 3    8.0       17717         0.10         3 herbivore  yes terrestrial  5</span>
<span class="co">#&gt; 4    7.5       11110         0.06         3 herbivore  yes terrestrial  3</span>
<span class="co">#&gt; 5    4.0        6500         0.11         3 herbivore  yes terrestrial  4</span>
<span class="co">#&gt; 6    2.8        1771         0.09         3 herbivore  yes terrestrial 16</span>
<span class="co">#&gt;    fat gest.month lacat.mo prot sugar energy</span>
<span class="co">#&gt; 1  7.0       9.02      4.5  6.3   5.2   1.21</span>
<span class="co">#&gt; 2 12.4       5.60      7.5  5.7    NA     NA</span>
<span class="co">#&gt; 3  7.5       8.32      8.0  4.1   5.3   1.13</span>
<span class="co">#&gt; 4  5.5       8.50      7.5  4.3   4.1   0.91</span>
<span class="co">#&gt; 5  8.6       8.00      4.0  5.6   4.9   1.31</span>
<span class="co">#&gt; 6  8.8       4.74      2.8  8.8    NA     NA</span>
<span class="kw">tail</span>(milk)
<span class="co">#&gt;                ord          fam                     spp mass.fem gest.mo</span>
<span class="co">#&gt; 125       Rodentia      Muridae     Pseudomys australis       65    1.02</span>
<span class="co">#&gt; 126       Rodentia      Muridae       Rattus norvegicus      253    0.71</span>
<span class="co">#&gt; 127       Rodentia Octodontidae           Octodon degus      235    2.96</span>
<span class="co">#&gt; 128       Rodentia    Scuiridae          Tamias amoenus       53    0.98</span>
<span class="co">#&gt; 129       Rodentia    Scuiridae Urocitellus columbianus      406    0.84</span>
<span class="co">#&gt; 130 Soricomorpha11    Soricidae       Crocidura russula       14    0.97</span>
<span class="co">#&gt;     lac.mo mass.litter repro.output dev.birth      diet arid       biome</span>
<span class="co">#&gt; 125    0.9          13         0.20         0 herbivore  yes terrestrial</span>
<span class="co">#&gt; 126    0.8          51         0.20         0  omnivore   no terrestrial</span>
<span class="co">#&gt; 127    1.2          74         0.31         3 herbivore  yes terrestrial</span>
<span class="co">#&gt; 128    1.5          14         0.26         0  omnivore   no terrestrial</span>
<span class="co">#&gt; 129    1.0          32         0.08         0 herbivore   no terrestrial</span>
<span class="co">#&gt; 130    0.8           4         0.29         0 carnivore   no terrestrial</span>
<span class="co">#&gt;          N  fat gest.month lacat.mo prot sugar energy</span>
<span class="co">#&gt; 125  7-Jun 12.1       1.02      0.9  6.4   3.6   1.62</span>
<span class="co">#&gt; 126 18-Mar  8.8       0.71      0.8  8.1   3.8   1.43</span>
<span class="co">#&gt; 127      7 20.1       2.96      1.2  4.4   2.7   2.20</span>
<span class="co">#&gt; 128     11 21.7       0.98      1.5  8.1   4.3   2.62</span>
<span class="co">#&gt; 129     26  9.2       0.84      1.0 10.7   3.4   1.60</span>
<span class="co">#&gt; 130      3 30.0       0.97      0.8  9.4   3.0   3.40</span>
<span class="kw">summary</span>(milk)
<span class="co">#&gt;             ord                  fam                          spp     </span>
<span class="co">#&gt;  Artiodactyla :23   Bovidae        :13   Acomys cahirinus       :  1  </span>
<span class="co">#&gt;  Carnivora    :23   Cercopithecidae: 8   Alces alces            :  1  </span>
<span class="co">#&gt;  Primates     :22   Cervidae       : 7   Aloutta palliata       :  1  </span>
<span class="co">#&gt;  Rodentia     :17   Muridae        : 7   Aloutta seniculus      :  1  </span>
<span class="co">#&gt;  Chiroptera   :10   Otariidae      : 7   Arctocephalus australis:  1  </span>
<span class="co">#&gt;  Diprotodontia:10   Phocidae       : 7   Arctocephalus gazella  :  1  </span>
<span class="co">#&gt;  (Other)      :25   (Other)        :81   (Other)                :124  </span>
<span class="co">#&gt;     mass.fem            gest.mo           lac.mo        mass.litter       </span>
<span class="co">#&gt;  Min.   :        8   Min.   : 0.400   Min.   : 0.300   Min.   :      0.3  </span>
<span class="co">#&gt;  1st Qu.:      857   1st Qu.: 1.405   1st Qu.: 1.625   1st Qu.:     42.0  </span>
<span class="co">#&gt;  Median :     5716   Median : 5.000   Median : 4.500   Median :    423.5  </span>
<span class="co">#&gt;  Mean   :  2229475   Mean   : 5.624   Mean   : 6.092   Mean   :  52563.8  </span>
<span class="co">#&gt;  3rd Qu.:   107500   3rd Qu.: 8.365   3rd Qu.: 8.225   3rd Qu.:   7038.2  </span>
<span class="co">#&gt;  Max.   :170000000   Max.   :21.460   Max.   :42.000   Max.   :2272500.0  </span>
<span class="co">#&gt;                                                                           </span>
<span class="co">#&gt;   repro.output       dev.birth            diet     arid   </span>
<span class="co">#&gt;  Min.   :0.00003   Min.   :0.000   carnivore:32   no :91  </span>
<span class="co">#&gt;  1st Qu.:0.04000   1st Qu.:1.000   herbivore:61   yes:39  </span>
<span class="co">#&gt;  Median :0.08000   Median :2.000   omnivore :37           </span>
<span class="co">#&gt;  Mean   :0.10374   Mean   :1.831                          </span>
<span class="co">#&gt;  3rd Qu.:0.13750   3rd Qu.:3.000                          </span>
<span class="co">#&gt;  Max.   :0.50000   Max.   :4.000                          </span>
<span class="co">#&gt;                                                           </span>
<span class="co">#&gt;          biome           N           fat          gest.month    </span>
<span class="co">#&gt;  aquatic    : 22   4      :13   Min.   : 0.20   Min.   : 0.400  </span>
<span class="co">#&gt;  terrestrial:108   3      :11   1st Qu.: 4.65   1st Qu.: 1.405  </span>
<span class="co">#&gt;                    6      :10   Median : 8.55   Median : 5.000  </span>
<span class="co">#&gt;                    7      : 9   Mean   :13.99   Mean   : 5.624  </span>
<span class="co">#&gt;                    5      : 8   3rd Qu.:16.82   3rd Qu.: 8.365  </span>
<span class="co">#&gt;                    24     : 5   Max.   :61.10   Max.   :21.460  </span>
<span class="co">#&gt;                    (Other):74                                   </span>
<span class="co">#&gt;     lacat.mo           prot            sugar           energy     </span>
<span class="co">#&gt;  Min.   : 0.300   Min.   : 1.100   Min.   : 0.02   Min.   :0.360  </span>
<span class="co">#&gt;  1st Qu.: 1.625   1st Qu.: 4.125   1st Qu.: 3.00   1st Qu.:0.965  </span>
<span class="co">#&gt;  Median : 4.500   Median : 6.750   Median : 4.70   Median :1.365  </span>
<span class="co">#&gt;  Mean   : 6.092   Mean   : 6.673   Mean   : 4.94   Mean   :1.680  </span>
<span class="co">#&gt;  3rd Qu.: 8.225   3rd Qu.: 9.200   3rd Qu.: 6.60   3rd Qu.:2.045  </span>
<span class="co">#&gt;  Max.   :42.000   Max.   :15.800   Max.   :14.00   Max.   :5.890  </span>
<span class="co">#&gt;                                    NA's   :16      NA's   :16</span></code></pre></div>
<p>Still some cleaning to do?</p>
</div>
</div>
</div>
<div id="graphical-exploratory-analsyes" class="section level2">
<h2 class="hasAnchor">
<a href="#graphical-exploratory-analsyes" class="anchor"></a>Graphical Exploratory Analsyes</h2>
<p>I follow the protocol outlined by Zuur et al 2010 A protocol for data exploration to avoid common statistical problems. Methods in Ecology &amp; Evolution 1:3-14.</p>
<div id="data-exploration-1-outlier-exploration" class="section level3">
<h3 class="hasAnchor">
<a href="#data-exploration-1-outlier-exploration" class="anchor"></a>Data exploration 1: Outlier exploration</h3>
<div id="data-exploration-1a-outlier-exploration-with-boxplots" class="section level4">
<h4 class="hasAnchor">
<a href="#data-exploration-1a-outlier-exploration-with-boxplots" class="anchor"></a>Data exploration 1a: Outlier exploration with boxplots</h4>
<p>In this analysis my main variables are</p>
<ol style="list-style-type: decimal">
<li>Predictor (x): Body mass of mothers (mass.fem)</li>
<li>Response (y): % milk fat of milk (fat)</li>
</ol>
<p>I will look at each one with a boxplot. If I am not plotting by a grouping variable I don’t need an ‘x =’ in ggboxplot().</p>
<p>I will make each plot and store it in an R object, then make a side by side plot using cowplot::plot_grid()</p>
<p>1st, make the graphs</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gg.mass &lt;-<span class="st"> </span><span class="kw">ggboxplot</span>(<span class="dt">data =</span> milk,
          <span class="dt">y =</span> <span class="st">"mass.fem"</span>,
          <span class="dt">main =</span> <span class="st">"Boxplot of female</span><span class="ch">\n</span><span class="st">mass (x)"</span>)

gg.fat &lt;-<span class="st"> </span><span class="kw">ggboxplot</span>(<span class="dt">data =</span> milk,
          <span class="dt">y =</span> <span class="st">"fat"</span>,
          <span class="dt">main =</span> <span class="st">"Boxplot of milk</span><span class="ch">\n</span><span class="st">fat (y)"</span>)</code></pre></div>
<p>Then plot them</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot_grid</span>(gg.mass, gg.fat)</code></pre></div>
<p><img src="Appendix-4a-Grapical_Exploratory_Analyses_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<p>There appear to be outliers in material mass. I will see if log transformation helps with this.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">milk<span class="op">$</span>fat.log10 &lt;-<span class="st"> </span><span class="kw">log10</span>(milk<span class="op">$</span>fat)
milk<span class="op">$</span>mass.fem.log10 &lt;-<span class="st"> </span><span class="kw">log10</span>(milk<span class="op">$</span>mass.fem)
milk<span class="op">$</span>fat.logit &lt;-<span class="st"> </span>arm<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/arm/topics/invlogit">logit</a></span>(milk<span class="op">$</span>fat<span class="op">/</span><span class="dv">100</span>)</code></pre></div>
<p>Make log plot</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gg.mass.log &lt;-<span class="st"> </span><span class="kw">ggboxplot</span>(<span class="dt">data =</span> milk,
          <span class="dt">y =</span> <span class="st">"mass.fem.log10"</span>,
          <span class="dt">main =</span> <span class="st">"Boxplot of log female</span><span class="ch">\n</span><span class="st">mass (x)"</span>)</code></pre></div>
<p>Plot log(mass) and fat</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot_grid</span>(gg.mass.log, gg.fat)</code></pre></div>
<p><img src="Appendix-4a-Grapical_Exploratory_Analyses_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
</div>
<div id="data-exploration-1b-outlier-exploration-with-dotplots" class="section level4">
<h4 class="hasAnchor">
<a href="#data-exploration-1b-outlier-exploration-with-dotplots" class="anchor"></a>Data exploration 1b: Outlier exploration with dotplots</h4>
<p>The (Cleveland) dotplot (or dotchart) can refer to several things. For data exploration and diagnostics purposes, a Cleveland dotplot plots a numeric value (x or y) against an index value. The index value can be</p>
<ul>
<li>the order the observation falls in the data (1 = 1st observation)</li>
<li>the rank of the observation within the data (1 = smallest observation)</li>
</ul>
<p>In ggpubr, the ggdotchart() function takes the numeric value of interest as the y variable. For the x variable , ggdotchart can take a numeric variable or a categorical variable. ggdotchart() then sorts the y-variable from the smallest to the largest value and plots it against the x-axis, which is treated as a categorical variable (even if its numeric). This is somewhat different that what the base R dotchart() function does which is featured in the Zuur et al 2010 paper.</p>
<p>For the x variable, what I think works well is to give ggdotchart() either</p>
<ol style="list-style-type: decimal">
<li>A categorical variable with many levels</li>
<li>A index of the order of</li>
</ol>
<p>Make an index</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">milk<span class="op">$</span>index &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(milk)</code></pre></div>
</div>
<div id="dot-plot-for-response-variable-y" class="section level4">
<h4 class="hasAnchor">
<a href="#dot-plot-for-response-variable-y" class="anchor"></a>Dot plot for response variable (y)</h4>
<p>Plot the dot chart based on index value. ggpubr allows us to color code by biome, which is nice. Overall what we are looking for is a big jump between data points, indicating an unusual observation the could be due to a <strong>data entry error.</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggdotchart</span>(<span class="dt">data =</span> milk,
          <span class="dt">y =</span> <span class="st">"fat"</span>,
          <span class="dt">x =</span> <span class="st">"index"</span>,
          <span class="dt">color =</span> <span class="st">"biome"</span>)</code></pre></div>
<p><img src="Appendix-4a-Grapical_Exploratory_Analyses_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<p>We can also facet by diet</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggdotchart</span>(<span class="dt">data =</span> milk,
          <span class="dt">y =</span> <span class="st">"fat"</span>,
          <span class="dt">x =</span> <span class="st">"index"</span>,
          <span class="dt">color =</span> <span class="st">"biome"</span>,
          <span class="dt">facet.by =</span> <span class="st">"diet"</span>)</code></pre></div>
<p><img src="Appendix-4a-Grapical_Exploratory_Analyses_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<p>Plot the dot chart based on species. This is ugly because the species names are so long.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggdotchart</span>(<span class="dt">data =</span> milk,
          <span class="dt">y =</span> <span class="st">"fat"</span>,
          <span class="dt">x =</span> <span class="st">"spp"</span>,
          <span class="dt">color =</span> <span class="st">"biome"</span>)</code></pre></div>
<p><img src="Appendix-4a-Grapical_Exploratory_Analyses_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<p>There are multiple species per family; this makes for an interesting perspective on how size correlates with family because there are now multiple values along the y axis for each value along the x axis.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggdotchart</span>(<span class="dt">data =</span> milk,
          <span class="dt">y =</span> <span class="st">"fat"</span>,
          <span class="dt">x =</span> <span class="st">"fam"</span>,
          <span class="dt">color =</span> <span class="st">"biome"</span>)</code></pre></div>
<p><img src="Appendix-4a-Grapical_Exploratory_Analyses_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<p>Similar for family, except more dots. Note that Carnivore now stands out as have a relatively large amount of variation</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggdotchart</span>(<span class="dt">data =</span> milk,
          <span class="dt">y =</span> <span class="st">"fat"</span>,
          <span class="dt">x =</span> <span class="st">"ord"</span>,
          <span class="dt">color =</span> <span class="st">"biome"</span>)</code></pre></div>
<p><img src="Appendix-4a-Grapical_Exploratory_Analyses_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
</div>
<div id="dotplot-for-predictor-variable-x" class="section level4">
<h4 class="hasAnchor">
<a href="#dotplot-for-predictor-variable-x" class="anchor"></a>Dotplot for predictor variable (x)</h4>
<p>In my carnivores there are data points which stick out a lot. This could be concerning. However, two things</p>
<p>1.There is a smooth swoop up; that is, highest point is part of an increasing trend.<br>
1. I know these data are the masses of mammals, which vary from mice to whales.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggdotchart</span>(<span class="dt">data =</span> milk,
          <span class="dt">y =</span> <span class="st">"mass.fem"</span>,
          <span class="dt">x =</span> <span class="st">"index"</span>,
          <span class="dt">color =</span> <span class="st">"biome"</span>,
          <span class="dt">facet.by =</span> <span class="st">"diet"</span>)</code></pre></div>
<p><img src="Appendix-4a-Grapical_Exploratory_Analyses_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
<p>So, this dotplot isn’t concerning, but I should double check the high values anyway. It wouldn’t hurt to log transform and check again after that.</p>
</div>
</div>
<div id="data-exploration-2-homogeneity-of-y-using-conditional-boxplot" class="section level3">
<h3 class="hasAnchor">
<a href="#data-exploration-2-homogeneity-of-y-using-conditional-boxplot" class="anchor"></a>Data exploration 2: Homogeneity of Y using Conditional boxplot</h3>
<p>A conditional boxplot is a boxplot of the data split apart by relevant groups. The distribution of the data (the box plot) is therefore conditional on or dependent on the grouping variable. In mathy terms we might write “distribution(y | group)” where “|” means “depends on.” (this isn’t a real thing, just supposed to be evocative of probability statement like Pr(Ho|data)).</p>
<p>The homogeneity of the y variable is an assumption of linear models - and an important one. (Recall that “homogeneity” refers to homogeneity of variance aka homoskedasticity) In contrast, linear models don’t assume anything about the distribution of the x variable. Its a good idea to make boxplots of your x (predictor) variables too, though, just to make sure you are familiar with the data and to make sure there isn’t anything goofy.</p>
<p>When things are not homogeneous (= heterskedastic) transformation can help fix things. In what follows I will explore the x and y variables with boxplot and try out a log transformation to fix things.</p>
<div id="untransformed-milk-fat-data-conditional-boxplot" class="section level4">
<h4 class="hasAnchor">
<a href="#untransformed-milk-fat-data-conditional-boxplot" class="anchor"></a>Untransformed milk fat data conditional boxplot</h4>
<p>Data is not skewed, but:</p>
<ol style="list-style-type: decimal">
<li>Variance appears to different between groups</li>
<li>Percentage data is necessarily bounded between 0 and 100% making it inherently non-normal</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggboxplot</span>(<span class="dt">data =</span> milk,
          <span class="dt">y =</span> <span class="st">"fat"</span>,
          <span class="dt">x =</span> <span class="st">"diet"</span>,
          <span class="dt">fill =</span> <span class="st">"biome"</span>,
          <span class="dt">xlab =</span> <span class="st">"Biome or habitat"</span>,
          <span class="dt">ylab =</span> <span class="st">"Milk fat (%)"</span>,
          <span class="dt">title =</span> <span class="st">"Distribution of raw milk fat data by biome &amp; diet"</span>)</code></pre></div>
<p><img src="Appendix-4a-Grapical_Exploratory_Analyses_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
</div>
<div id="transformed-data-conditional-boxplot" class="section level4">
<h4 class="hasAnchor">
<a href="#transformed-data-conditional-boxplot" class="anchor"></a>Transformed data conditional boxplot</h4>
<p>Transformation stabilizes variance.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">ggboxplot</span>(<span class="dt">data =</span> milk,
          <span class="dt">y =</span> <span class="st">"fat.log10"</span>,
          <span class="dt">x =</span> <span class="st">"diet"</span>,
          <span class="dt">fill =</span> <span class="st">"biome"</span>,
          <span class="dt">xlab =</span> <span class="st">"Biome or habitat"</span>,
          <span class="dt">ylab =</span> <span class="st">"Milk fat (%)"</span>,
          <span class="dt">title =</span> <span class="st">"Transormed Distribution of raw milk fat data by biome &amp; diet"</span>)</code></pre></div>
<p><img src="Appendix-4a-Grapical_Exploratory_Analyses_files/figure-html/unnamed-chunk-19-1.png" width="700"></p>
</div>
<div id="x-variable-exploration-female-size-conditional-boxplots" class="section level4">
<h4 class="hasAnchor">
<a href="#x-variable-exploration-female-size-conditional-boxplots" class="anchor"></a>X variable exploration: Female size conditional boxplots</h4>
<p>We don’t assume that the X variable is homogenous, but its good to explore the data using conditional boxplots also.</p>
<div id="untransformed-size-data" class="section level5">
<h5 class="hasAnchor">
<a href="#untransformed-size-data" class="anchor"></a>Untransformed size data</h5>
<p>Data is highly skewed, which will create influential data points due to high leverage.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggboxplot</span>(<span class="dt">data =</span> milk,
          <span class="dt">y =</span> <span class="st">"mass.fem"</span>,
          <span class="dt">x =</span> <span class="st">"diet"</span>,
          <span class="dt">fill =</span> <span class="st">"biome"</span>,
          <span class="dt">xlab =</span> <span class="st">"Biome or habitat"</span>,
          <span class="dt">ylab =</span> <span class="st">"Milk fat (%)"</span>,
          <span class="dt">title =</span> <span class="st">"Distribution of raw milk fat data by biome &amp; diet"</span>)</code></pre></div>
<p><img src="Appendix-4a-Grapical_Exploratory_Analyses_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
</div>
<div id="transformed-size-data" class="section level5">
<h5 class="hasAnchor">
<a href="#transformed-size-data" class="anchor"></a>Transformed size data</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">milk<span class="op">$</span>mass.fem.log10 &lt;-<span class="st"> </span><span class="kw">log10</span>(milk<span class="op">$</span>mass.fem)

<span class="kw">ggboxplot</span>(<span class="dt">data =</span> milk,
          <span class="dt">y =</span> <span class="st">"mass.fem.log10"</span>,
          <span class="dt">x =</span> <span class="st">"diet"</span>,
          <span class="dt">fill =</span> <span class="st">"biome"</span>,
          <span class="dt">xlab =</span> <span class="st">"Biome or habitat"</span>,
          <span class="dt">ylab =</span> <span class="st">"Milk fat (%)"</span>,
          <span class="dt">title =</span> <span class="st">"Distribution of raw milk fat data by biome &amp; diet"</span>)</code></pre></div>
<p><img src="Appendix-4a-Grapical_Exploratory_Analyses_files/figure-html/unnamed-chunk-21-1.png" width="700"></p>
</div>
</div>
</div>
<div id="data-exploration-3-normality" class="section level3">
<h3 class="hasAnchor">
<a href="#data-exploration-3-normality" class="anchor"></a>Data exploration 3: Normality</h3>
<blockquote>
<p>“In linear regression, we actually assume normality of all the replicate observations at a particular covriate value … However, normality of the raw data implies normality of the residuals” (Zuur et al 2010)</p>
</blockquote>
<p>The normality assumption is generally best dealt with after fitting a model. However, you can start to get a sense for it by plotting histograms (And to some extent boxplot) of the data split up by major grouping variables (“conditional boxplots” using Zuur’s nomenclature). This conditioning can be done by using ggplot’s faceting ability.</p>
<p>If you are doing a t-test or ANOVA, these histograms of the raw data conditional by group will be equivalent to plots of the residuals after fitting the model. For ANCOVA and multiple regression, however, you need to actually fit the model.</p>
<p>Note that normality applies to the y variable. It never hurts to explore the x variables too, though.</p>
<p>I already know that a log transformation is needed, so I’ll skip with the raw data and just look at the log10 values</p>
<p>I will be doing regression and so I need to fit a model. However, I do have major categorical variables to consider, so I’ll make a histogram to see what it looks like.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gghistogram</span>(<span class="dt">data =</span> milk, 
            <span class="dt">x =</span> <span class="st">"mass.fem.log10"</span>,
            <span class="dt">facet.by =</span> <span class="st">"diet"</span>)
<span class="co">#&gt; Warning: Using `bins = 30` by default. Pick better value with the argument</span>
<span class="co">#&gt; `bins`.</span></code></pre></div>
<p><img src="Appendix-4a-Grapical_Exploratory_Analyses_files/figure-html/unnamed-chunk-22-1.png" width="700"></p>
<p>Even after a log transformation the data aren’t super normal. However, further conditioning on biome could make this better; also, as I’ve already said, I need to actually fit my regression model and look at the residuals to really pass judgement. Moreover, I don’t get hung up on normality unless things are really really skewed.</p>
<p>I could add biome in indirectly by making a combined variable I“ll call group”</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">milk<span class="op">$</span>group &lt;-<span class="st"> </span><span class="kw">paste</span>(milk<span class="op">$</span>biome, milk<span class="op">$</span>diet)
<span class="kw">gghistogram</span>(<span class="dt">data =</span> milk, 
            <span class="dt">x =</span> <span class="st">"mass.fem.log10"</span>,
            <span class="dt">facet.by =</span> <span class="st">"group"</span>,
            <span class="dt">fill =</span> <span class="st">"diet"</span>)
<span class="co">#&gt; Warning: Using `bins = 30` by default. Pick better value with the argument</span>
<span class="co">#&gt; `bins`.</span></code></pre></div>
<p><img src="Appendix-4a-Grapical_Exploratory_Analyses_files/figure-html/unnamed-chunk-23-1.png" width="700"></p>
<p>This reveals that terrestrial carnivores are kinda skewed. However, with few data points its hard to tell. Overall these data are that normal, but see the caveats above as to why I am not in the least concerned at this stage.</p>
</div>
<div id="data-exploration-with-scatter-plots" class="section level3">
<h3 class="hasAnchor">
<a href="#data-exploration-with-scatter-plots" class="anchor"></a>Data exploration with Scatter plots</h3>
<p>A scatter plot of predictors versus response variables is also key to data exploration, as well as final data presentation</p>
<div id="scatter-plot-of-raw-data" class="section level4">
<h4 class="hasAnchor">
<a href="#scatter-plot-of-raw-data" class="anchor"></a>Scatter plot of raw data</h4>
<p>I already know that log transformation are probably key to working with this data, but its interesting to look at the raw data. We can see how the far right data point exerts leverage on the regression line.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggscatter</span>(<span class="dt">data =</span> milk,
          <span class="dt">y =</span> <span class="st">"fat"</span>,
          <span class="dt">x =</span> <span class="st">"mass.fem"</span>,
          <span class="dt">add =</span> <span class="st">"reg.line"</span>,
          <span class="dt">color =</span> <span class="st">"diet"</span>)</code></pre></div>
<p><img src="Appendix-4a-Grapical_Exploratory_Analyses_files/figure-html/unnamed-chunk-24-1.png" width="700"></p>
</div>
<div id="scatter-plot-of-transormed-data" class="section level4">
<h4 class="hasAnchor">
<a href="#scatter-plot-of-transormed-data" class="anchor"></a>Scatter plot of transormed data</h4>
<p>Log transformation deals with high leverage values (extreme x axis values due to large size of the animals), pulls in potential y axis outliers, improves normality, and stabilizes variance within groups. Awesome!</p>
<p>One problem remains. This scatter plot indicates that the variance within each major group appears to increase as size increase. This occurs even in the log-transformed data. This is major issue that can only be addressed through the use of generalized least squares (GLS) and/or random effects. See the following paper for more details</p>
<p>Cleasby &amp; Nakagawa. 2011. Neglected biological patterns in the residuals. <a href="https://link.springer.com/article/10.1007/s00265-011-1254-7">Behavioral Ecology and Sociobiology.</a></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggscatter</span>(<span class="dt">data =</span> milk,
          <span class="dt">y =</span> <span class="st">"fat.log10"</span>,
          <span class="dt">x =</span> <span class="st">"mass.fem.log10"</span>,
          <span class="dt">add =</span> <span class="st">"reg.line"</span>,
          <span class="dt">color =</span> <span class="st">"diet"</span>,
          <span class="dt">facet.by =</span> <span class="st">"biome"</span>)</code></pre></div>
<p><img src="Appendix-4a-Grapical_Exploratory_Analyses_files/figure-html/unnamed-chunk-25-1.png" width="700"></p>
</div>
<div id="other-scatter-plot-elements" class="section level4">
<h4 class="hasAnchor">
<a href="#other-scatter-plot-elements" class="anchor"></a>Other Scatter plot elements</h4>
<div id="rugs" class="section level5">
<h5 class="hasAnchor">
<a href="#rugs" class="anchor"></a>Rugs</h5>
<p>Add a “rug” to help with visualizing the data distributions.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggscatter</span>(<span class="dt">data =</span> milk,
          <span class="dt">y =</span> <span class="st">"fat.log10"</span>,
          <span class="dt">x =</span> <span class="st">"mass.fem.log10"</span>,
          <span class="dt">add =</span> <span class="st">"reg.line"</span>,
          <span class="dt">color =</span> <span class="st">"diet"</span>,
          <span class="dt">facet.by =</span> <span class="st">"biome"</span>,
          <span class="dt">rug =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><img src="Appendix-4a-Grapical_Exploratory_Analyses_files/figure-html/unnamed-chunk-26-1.png" width="700"></p>
</div>
<div id="add-mean-point-and-scatter-plot-ellipse" class="section level5">
<h5 class="hasAnchor">
<a href="#add-mean-point-and-scatter-plot-ellipse" class="anchor"></a>Add mean point and scatter plot ellipse</h5>
<p>Add a point for the bi-variate mean of the data (joint mean along both axes). Note how it falls on the regression line.</p>
<p>Also add a “data ellipse”</p>
<blockquote>
<p>“The data ellipse is typically used to add a visual summary to a scatterplot, indicating the means, standard deviations, correlation and slope of the regression line for two variables.” (Friendly et al 2013 Elliptical Insights: Understanding Statistical Methods through Elliptical Geometry)</p>
</blockquote>
<p>The ellipse is joint 95% confidence interval in both dimensions. You could calculate the mean of the x variable and calculate a confidence interval around, then calculate the mean of the y variable and a 95% CI. The ellipse basically simultaneously merges these two things.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggscatter</span>(<span class="dt">data =</span> milk,
          <span class="dt">y =</span> <span class="st">"fat.log10"</span>,
          <span class="dt">x =</span> <span class="st">"mass.fem.log10"</span>,
          <span class="dt">add =</span> <span class="st">"reg.line"</span>,
          <span class="dt">color =</span> <span class="st">"diet"</span>,
          <span class="dt">facet.by =</span> <span class="st">"group"</span>,
          <span class="dt">mean.point =</span> <span class="ot">TRUE</span>,
          <span class="dt">ellipse =</span> <span class="ot">TRUE</span>,
          <span class="dt">ellipse.border.remove =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><img src="Appendix-4a-Grapical_Exploratory_Analyses_files/figure-html/unnamed-chunk-27-1.png" width="700"></p>
</div>
</div>
</div>
<div id="data-exploration-4-excess-zeros" class="section level3">
<h3 class="hasAnchor">
<a href="#data-exploration-4-excess-zeros" class="anchor"></a>Data exploration 4: Excess zeros</h3>
<p>When you have count data you frequently use Poisson regression. Like linear regression, Poisson regression makes assumptions about the distribution of the data. Count data with lots of zeros violates these assumptions.</p>
</div>
<div id="data-exploration-collinearity" class="section level3">
<h3 class="hasAnchor">
<a href="#data-exploration-collinearity" class="anchor"></a>Data exploration: Collinearity</h3>
<p>When predictor variables are highly correlated with each other this causes problems with estimating and making inference with regression.</p>
<p>My analysis focuses just on female mass as a numeric predictor. The original analysis considered a number of other predictors, but did not explicitly discuss collinearity issues.</p>
<div id="table-of-correlations" class="section level4">
<h4 class="hasAnchor">
<a href="#table-of-correlations" class="anchor"></a>Table of correlations</h4>
<p>One way of getting a sense for collinearity is to look at a table of correlation coefficients for you predictors. I’ll also include the response variable fat.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">milk<span class="op">$</span>mass.litter.log10 &lt;-<span class="st"> </span><span class="kw">log10</span>(milk<span class="op">$</span>mass.litter)
variables. &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"mass.fem.log10"</span>, <span class="st">"gest.mo"</span>, <span class="st">"lac.mo"</span>, <span class="st">"mass.litter.log10"</span>, <span class="st">"repro.output"</span>, <span class="st">"fat.log10"</span>)



correlation.table &lt;-<span class="st"> </span><span class="kw">cor</span>(milk[,variables.])

<span class="co"># a little trick to remove the lower part</span>
correlation.table[<span class="kw">lower.tri</span>(correlation.table)] &lt;-<span class="st"> </span><span class="ot">NA</span>


<span class="kw">round</span>(correlation.table,<span class="dv">3</span>)
<span class="co">#&gt;                   mass.fem.log10 gest.mo lac.mo mass.litter.log10</span>
<span class="co">#&gt; mass.fem.log10                 1    0.76  0.444             0.829</span>
<span class="co">#&gt; gest.mo                       NA    1.00  0.574             0.803</span>
<span class="co">#&gt; lac.mo                        NA      NA  1.000             0.286</span>
<span class="co">#&gt; mass.litter.log10             NA      NA     NA             1.000</span>
<span class="co">#&gt; repro.output                  NA      NA     NA                NA</span>
<span class="co">#&gt; fat.log10                     NA      NA     NA                NA</span>
<span class="co">#&gt;                   repro.output fat.log10</span>
<span class="co">#&gt; mass.fem.log10          -0.568     0.073</span>
<span class="co">#&gt; gest.mo                 -0.245    -0.032</span>
<span class="co">#&gt; lac.mo                  -0.357    -0.274</span>
<span class="co">#&gt; mass.litter.log10       -0.146     0.109</span>
<span class="co">#&gt; repro.output             1.000     0.196</span>
<span class="co">#&gt; fat.log10                   NA     1.000</span></code></pre></div>
<p>You can get p-value for you correlations using corr.test from the psych package</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">psych<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/psych/topics/corr.test">corr.test</a></span>(milk[,variables.])
<span class="co">#&gt; Call:psych::corr.test(x = milk[, variables.])</span>
<span class="co">#&gt; Correlation matrix </span>
<span class="co">#&gt;                   mass.fem.log10 gest.mo lac.mo mass.litter.log10</span>
<span class="co">#&gt; mass.fem.log10              1.00    0.76   0.44              0.83</span>
<span class="co">#&gt; gest.mo                     0.76    1.00   0.57              0.80</span>
<span class="co">#&gt; lac.mo                      0.44    0.57   1.00              0.29</span>
<span class="co">#&gt; mass.litter.log10           0.83    0.80   0.29              1.00</span>
<span class="co">#&gt; repro.output               -0.57   -0.25  -0.36             -0.15</span>
<span class="co">#&gt; fat.log10                   0.07   -0.03  -0.27              0.11</span>
<span class="co">#&gt;                   repro.output fat.log10</span>
<span class="co">#&gt; mass.fem.log10           -0.57      0.07</span>
<span class="co">#&gt; gest.mo                  -0.25     -0.03</span>
<span class="co">#&gt; lac.mo                   -0.36     -0.27</span>
<span class="co">#&gt; mass.litter.log10        -0.15      0.11</span>
<span class="co">#&gt; repro.output              1.00      0.20</span>
<span class="co">#&gt; fat.log10                 0.20      1.00</span>
<span class="co">#&gt; Sample Size </span>
<span class="co">#&gt; [1] 130</span>
<span class="co">#&gt; Probability values (Entries above the diagonal are adjusted for multiple tests.) </span>
<span class="co">#&gt;                   mass.fem.log10 gest.mo lac.mo mass.litter.log10</span>
<span class="co">#&gt; mass.fem.log10              0.00    0.00      0              0.00</span>
<span class="co">#&gt; gest.mo                     0.00    0.00      0              0.00</span>
<span class="co">#&gt; lac.mo                      0.00    0.00      0              0.01</span>
<span class="co">#&gt; mass.litter.log10           0.00    0.00      0              0.00</span>
<span class="co">#&gt; repro.output                0.00    0.00      0              0.10</span>
<span class="co">#&gt; fat.log10                   0.41    0.71      0              0.22</span>
<span class="co">#&gt;                   repro.output fat.log10</span>
<span class="co">#&gt; mass.fem.log10            0.00      0.82</span>
<span class="co">#&gt; gest.mo                   0.03      0.82</span>
<span class="co">#&gt; lac.mo                    0.00      0.01</span>
<span class="co">#&gt; mass.litter.log10         0.39      0.65</span>
<span class="co">#&gt; repro.output              0.00      0.13</span>
<span class="co">#&gt; fat.log10                 0.03      0.00</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  To see confidence intervals of the correlations, print with the short=FALSE option</span></code></pre></div>
<p>Note that variables are perfectly correlated with each other, so the diagonal elements are all 1. High positive or negative values indicate values that are highly correlated and which will pose problems if both included in regression. Collinearity can be subtle, though, so full diagnostics using variance inflation factors need to be use once the model is fit.</p>
<p>We can get a visual representation of this with GGally::ggpairs, which gives us a <strong>sactterplot matrix</strong>, histograms for each variable, and the correlation coeffeictions.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">GGally<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/GGally/topics/ggpairs">ggpairs</a></span>(milk[,variables.])</code></pre></div>
<p><img src="Appendix-4a-Grapical_Exploratory_Analyses_files/figure-html/unnamed-chunk-31-1.png" width="700"></p>
<p>GGally::ggpairs is pretty slow; old fashioned pairs() is faster.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pairs</span>(milk[,variables.])</code></pre></div>
<p><img src="Appendix-4a-Grapical_Exploratory_Analyses_files/figure-html/unnamed-chunk-32-1.png" width="700"></p>
<p>You can add correlations and histograms if you add some functions. See the help file ?pairs for details.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#function form help file for hist</span>
panel.hist &lt;-<span class="st"> </span><span class="cf">function</span>(x, ...)
{
    usr &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="st">"usr"</span>); <span class="kw">on.exit</span>(<span class="kw">par</span>(usr))
    <span class="kw">par</span>(<span class="dt">usr =</span> <span class="kw">c</span>(usr[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], <span class="dv">0</span>, <span class="fl">1.5</span>) )
    h &lt;-<span class="st"> </span><span class="kw">hist</span>(x, <span class="dt">plot =</span> <span class="ot">FALSE</span>)
    breaks &lt;-<span class="st"> </span>h<span class="op">$</span>breaks; nB &lt;-<span class="st"> </span><span class="kw">length</span>(breaks)
    y &lt;-<span class="st"> </span>h<span class="op">$</span>counts; y &lt;-<span class="st"> </span>y<span class="op">/</span><span class="kw">max</span>(y)
    <span class="kw">rect</span>(breaks[<span class="op">-</span>nB], <span class="dv">0</span>, breaks[<span class="op">-</span><span class="dv">1</span>], y, <span class="dt">col =</span> <span class="st">"cyan"</span>, ...)
}

<span class="co">#function form help file for correlation</span>
panel.cor &lt;-<span class="st"> </span><span class="cf">function</span>(x, y, <span class="dt">digits =</span> <span class="dv">2</span>, <span class="dt">prefix =</span> <span class="st">""</span>, cex.cor, ...)
{
    usr &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="st">"usr"</span>); <span class="kw">on.exit</span>(<span class="kw">par</span>(usr))
    <span class="kw">par</span>(<span class="dt">usr =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>))
    r &lt;-<span class="st"> </span><span class="kw">abs</span>(<span class="kw">cor</span>(x, y))
    txt &lt;-<span class="st"> </span><span class="kw">format</span>(<span class="kw">c</span>(r, <span class="fl">0.123456789</span>), <span class="dt">digits =</span> digits)[<span class="dv">1</span>]
    txt &lt;-<span class="st"> </span><span class="kw">paste0</span>(prefix, txt)
    <span class="cf">if</span>(<span class="kw">missing</span>(cex.cor)) cex.cor &lt;-<span class="st"> </span><span class="fl">0.8</span><span class="op">/</span><span class="kw">strwidth</span>(txt)
    <span class="kw">text</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, txt, <span class="dt">cex =</span> cex.cor <span class="op">*</span><span class="st"> </span>r)
}


<span class="co"># plot it</span>
<span class="kw">pairs</span>(milk[,variables.],
      <span class="dt">diag.panel =</span> panel.hist,
      <span class="dt">lower.panel =</span> panel.smooth,
      <span class="dt">upper.panel =</span> panel.cor)</code></pre></div>
<p><img src="Appendix-4a-Grapical_Exploratory_Analyses_files/figure-html/unnamed-chunk-33-1.png" width="700"></p>
<p>For information on variance inflation factors see: Graham 2003. Confronting multicollinearity in ecological multiple regression. Ecology.</p>
<p>For more on collienarity see: Freckleton. 2011. Dealing with collinearity in behavioral and ecological data: model averaging and the problems of measurement error. Behavioral Ecology and Sociobiology. <a href="https://link.springer.com/article/10.1007/s00265-010-1045-6" class="uri">https://link.springer.com/article/10.1007/s00265-010-1045-6</a></p>
</div>
</div>
<div id="data-exploration-6-relationship-between-y-x" class="section level3">
<h3 class="hasAnchor">
<a href="#data-exploration-6-relationship-between-y-x" class="anchor"></a>Data exploration 6: Relationship between y &amp; x</h3>
<p>We’ve already looked a scatterplot of the x versus y variable and scatterplot matrix.</p>
<p>One thing that hasn’t been emphasized is that ggscatter() non-linear “smoothers” using add = “loess”. This can be useful for see if there non-linear relationships.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">milk<span class="op">$</span>lacat.mo.log10 &lt;-<span class="st"> </span><span class="kw">log10</span>(milk<span class="op">$</span>lacat.mo)
<span class="kw">ggscatter</span>(<span class="dt">data =</span> milk,
          <span class="dt">y =</span> <span class="st">"fat.log10"</span>,
          <span class="dt">x =</span> <span class="st">"lacat.mo.log10"</span>,
          <span class="dt">add =</span> <span class="st">"loess"</span>)</code></pre></div>
<p><img src="Appendix-4a-Grapical_Exploratory_Analyses_files/figure-html/unnamed-chunk-34-1.png" width="700"></p>
</div>
<div id="data-exploration-7-should-we-consider-interactions" class="section level3">
<h3 class="hasAnchor">
<a href="#data-exploration-7-should-we-consider-interactions" class="anchor"></a>Data exploration 7: Should we consider interactions?</h3>
<p>When interactions occur, relationships between two variables depend on a third. For example, scatterplots coded by color and/or faceted used above indicate that the slope of fat vs body size is positive for aquatic carnivores but negative for other groups.</p>
</div>
<div id="data-exploration-8-are-observations-of-the-response-variable-independent" class="section level3">
<h3 class="hasAnchor">
<a href="#data-exploration-8-are-observations-of-the-response-variable-independent" class="anchor"></a>Data exploration 8: Are observations of the response variable independent?</h3>
<p>When data are collected as part of a time series, repeated measures on the same thing, or from adjacent fixed points in space there is the potential for autocorrelation patterns. This is not applicable for the mammals milk dataset.</p>
<p>The data do have issues with phylogenetic structure. This would be best dealt with using phylogenetic reression methods; I don’t have the phylogeny handy so I will use the coarse-level clustering by Order, Family and Genus to approximate this.</p>
</div>
</div>
<div id="numeric-data-summaries" class="section level2">
<h2 class="hasAnchor">
<a href="#numeric-data-summaries" class="anchor"></a>Numeric data summaries</h2>
<p>It can be very useful to generate numeric data summaries to help you and readers understand the data. This is not emphasized by Zuur</p>
<div id="table-of-means-sds" class="section level3">
<h3 class="hasAnchor">
<a href="#table-of-means-sds" class="anchor"></a>Table of means &amp; SDs</h3>
<div id="mass-by-diet-group" class="section level4">
<h4 class="hasAnchor">
<a href="#mass-by-diet-group" class="anchor"></a>Mass by diet group</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">milk <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(diet) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mass.mean =</span> <span class="kw">mean</span>(mass.fem),
            <span class="dt">mass.sd =</span> <span class="kw">sd</span>(mass.fem),
            <span class="dt">mass.n =</span> <span class="kw">n</span>()
            )
<span class="co">#&gt; # A tibble: 3 x 4</span>
<span class="co">#&gt;   diet      mass.mean   mass.sd mass.n</span>
<span class="co">#&gt;   &lt;fct&gt;         &lt;dbl&gt;     &lt;dbl&gt;  &lt;int&gt;</span>
<span class="co">#&gt; 1 carnivore  8646393. 32150168.     32</span>
<span class="co">#&gt; 2 herbivore   207403.   492666.     61</span>
<span class="co">#&gt; 3 omnivore     13396.    36423.     37</span></code></pre></div>
</div>
<div id="milk-fat-by-diet-group" class="section level4">
<h4 class="hasAnchor">
<a href="#milk-fat-by-diet-group" class="anchor"></a>Milk fat by diet group</h4>
<p>These data appear in Figure 2a of the original publication</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">milk <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(diet) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">fat.mean =</span> <span class="kw">mean</span>(fat),
            <span class="dt">fat.sd =</span> <span class="kw">sd</span>(fat),
            <span class="dt">fat.SE =</span> plotrix<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/plotrix/topics/std.error">std.error</a></span>(fat),
            <span class="dt">fat.n =</span> <span class="kw">n</span>())
<span class="co">#&gt; # A tibble: 3 x 5</span>
<span class="co">#&gt;   diet      fat.mean fat.sd fat.SE fat.n</span>
<span class="co">#&gt;   &lt;fct&gt;        &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt;</span>
<span class="co">#&gt; 1 carnivore    32.3   16.8   2.96     32</span>
<span class="co">#&gt; 2 herbivore     8.06   5.19  0.664    61</span>
<span class="co">#&gt; 3 omnivore      7.90   6.45  1.06     37</span></code></pre></div>
</div>
</div>
<div id="data-exploration-summary" class="section level3">
<h3 class="hasAnchor">
<a href="#data-exploration-summary" class="anchor"></a>Data exploration summary</h3>
<p>These data require transformation to meet the assumptions of linear regression. The response (fat) appears to have heterogeneous variances between major groups (eg diet categories) and also since its a percentage is inherently non-normal. Log transformation, as done in the original paper, improves the variance and normality. A logit transformation might be more appropriate because it it percentage data.</p>
<p>The major x variable, female body size, has several outliers due to the broad ranges of body sizes of the organisms. Log transformation improves this.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#preliminaries">Preliminaries</a></li>
      <li><a href="#graphical-exploratory-analsyes">Graphical Exploratory Analsyes</a></li>
      <li><a href="#numeric-data-summaries">Numeric data summaries</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by First Last.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
