<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Appendix 7) Robustness checks • mammalsmilkRA</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Appendix 7) Robustness checks">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mammalsmilkRA</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Appendix-0-README.html">Appendix 0) Final Project Analysis Compendium README</a>
    </li>
    <li>
      <a href="../articles/Appendix-1-raw_data_README.html">Appendix 1) Raw data (REQUIRED)</a>
    </li>
    <li>
      <a href="../articles/Appendix-2-data_cleaning.html">Appendix 2) Data Preparation &amp; Cleaning (.R or doc)</a>
    </li>
    <li>
      <a href="../articles/Appendix-2-data_dictionary.html">Appendix 2) Data dictionary (REQUIRED)</a>
    </li>
    <li>
      <a href="../articles/Appendix-3-Analysis_data-README.html">Appendix 3) Analysis data (Data file REQUIRED)</a>
    </li>
    <li>
      <a href="../articles/Appendix-4a-Grapical_Exploratory_Analyses.html">Appendix 4a) Graphical Exploratory Analysis (REQUIRED)</a>
    </li>
    <li>
      <a href="../articles/Appendix-4b-Numeric_Exploratory_Analyses.html">Appendix 4b) Numeric Summaries &amp; Exploratory Analysis (REQUIRED)</a>
    </li>
    <li>
      <a href="../articles/Appendix-5-study_diagram.html">Appendix 5) Study Diagrams (REQUIRED)</a>
    </li>
    <li>
      <a href="../articles/Appendix-6a-Analysis-script.html">Appendix 6a) Analysis script (REQUIRED)</a>
    </li>
    <li>
      <a href="../articles/Appendix-6b-Model-diagnostics-and-outliers.html">Appendix 6b) Model diagnostics (REQUIRED)</a>
    </li>
    <li>
      <a href="../articles/Appendix-6c-Primary_figure.html">Appendix 6c) Primary Figure code (REQURIED)</a>
    </li>
    <li>
      <a href="../articles/Appendix-7-Robustness_check.html">Appendix 7) Robustness checks</a>
    </li>
    <li>
      <a href="../articles/MS-1-Introduction.html">MS Part 1) Introduction</a>
    </li>
    <li>
      <a href="../articles/MS-2-Methods.html">MS Part 2) Methods</a>
    </li>
    <li>
      <a href="../articles/MS-3a-Results-written.html">MS Part 3a) Result - written</a>
    </li>
    <li>
      <a href="../articles/MS-3b-Results_model_equation.html">MS part 3b) Results - model equation</a>
    </li>
    <li>
      <a href="../articles/MS-3c-Results-key_figure.html">MS Part 3c) Key figure (image, pptx)</a>
    </li>
    <li>
      <a href="../articles/MS-4-Discussion.html">MC 4) Discussion</a>
    </li>
    <li>
      <a href="../articles/v-FAQ.html">f) Frequently asked questions</a>
    </li>
    <li>
      <a href="../articles/w-references.html">r) References</a>
    </li>
    <li>
      <a href="../articles/y-creating_the_package.html">z) Creating this package</a>
    </li>
    <li>
      <a href="../articles/z-build_and_rebuild_package.html">z) Building and rebuilding vignettes</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Appendix 7) Robustness checks</h1>
                        <h4 class="author">Vignette Author</h4>
            
            <h4 class="date">2018-12-10</h4>
      
      
      <div class="hidden name"><code>Appendix-7-Robustness_check.Rmd</code></div>

    </div>

    
    
<p>The results of analyses can frequently depend at least to some extent on the exact format of the data and analyses performed. Outlier removal and transformation frequently change p-values, as can running one type of test versus another, such as a Welch’s test versus a standard t-test on log-transformed data.</p>
<p>Manipulating your data to yield the results you want or picking an analysis the gives you the lowest p-value is a form of p-hacking. The flip size of p-hacking are <strong>sensitivity analyses</strong> and <strong>robustness checks</strong>. The most common type of sensitivty analysis is to report the results of an analysis with and without outliers or influential points to demonstrate that the results are not changed substantially by any changes. You can similarly report the results of multiple similar models, subsets of the data, etc to demonstrate the the results are not sensitivty to the details (or conversly are robust to these changes).</p>
<p>The term <strong>robustness check</strong> comes from economics and is fairly common there. As I understand it, stats-intentive economics papers frequently include presentation of alternative modeling approachs to demonstate that the main results are robust to the finer points of the modeling. As far as I know most other fields, including biology, do not use these terms nor regularly report on robustness; the only exception might be for outliers, and it seems usually this is just done informally using a parenthetical statement along the lines “results were qualitatively similar after removal of outliers” or something like that.</p>
<p>I personally think sensitivity/robustness should be emphasized more while both reporting analyses and also learnign stats. It can be very surpising how much p-values can changed depending on what exactly you do - and it can be comforting to see how things <em>don’t</em> change despite any monkeying with your model.</p>
<p>In 2018 I would like students whose primary analysis is just a t-test to perform at least one alternative analysis to examine the robustness of their results. This should be done in a seperate appendix so its obvious to me where its done. You can chose to compare</p>
<ol style="list-style-type: decimal">
<li>Welch’s t-test to a non-parametric Wilcoxon Rank-sum test</li>
<li>Welch’s t-test to a linear model using “generalized least squares” (gls) to explicitly model the different variances in your groups</li>
<li>If you are doing multiple t-tests carry out an experiment-wise multiple comparisons correction using at least two different correction methods</li>
</ol>
<p>These different approaches are demonstrated below. For your project you just need to write functioning annotated code to carry out the tasks.</p>
<p>(Aside: sensitivty analyses are common in x-ray crystalography (Googins, pesonal communication); I have seen them used in phylogenetic analysses)</p>
<div id="preliminaries" class="section level2">
<h2 class="hasAnchor">
<a href="#preliminaries" class="anchor"></a>Preliminaries</h2>
<div id="load-packages" class="section level3">
<h3 class="hasAnchor">
<a href="#load-packages" class="anchor"></a>Load packages</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggpubr) <span class="co"># plotting using ggplto2</span>
<span class="kw">library</span>(cowplot)
<span class="kw">library</span>(bbmle)
<span class="kw">library</span>(nlme)
<span class="kw">library</span>(here)
<span class="kw">library</span>(stringi)
<span class="kw">library</span>(stringr)</code></pre></div>
</div>
<div id="load-data-in-r" class="section level3">
<h3 class="hasAnchor">
<a href="#load-data-in-r" class="anchor"></a>Load data in R</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">file. &lt;-<span class="st"> "Appendix-2-Analysis-Data_mammalsmilkRA.csv"</span>
path. &lt;-<span class="st"> </span><span class="kw">here</span>(<span class="st">"/inst/extdata/"</span>,file.)

milk &lt;-<span class="st"> </span><span class="kw">read.csv</span>(path., <span class="dt">skip =</span> <span class="dv">3</span>)


genus_spp_subspp_mat &lt;-<span class="st"> </span>milk<span class="op">$</span>spp <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">str_split_fixed</span>(<span class="st">" "</span>, <span class="dt">n =</span> <span class="dv">3</span>)

milk<span class="op">$</span>genus &lt;-<span class="st"> </span>genus_spp_subspp_mat[,<span class="dv">1</span>]</code></pre></div>
<p>Set log</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">milk<span class="op">$</span>fat.log &lt;-<span class="st"> </span><span class="kw">log</span>(milk<span class="op">$</span>fat)</code></pre></div>
</div>
<div id="plot-data" class="section level3">
<h3 class="hasAnchor">
<a href="#plot-data" class="anchor"></a>Plot data</h3>
<p>Data is non-normal and variacnes not equal between arid-dwelling and non-arid aniamls</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ggpubr<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggpubr/topics/ggboxplot">ggboxplot</a></span>(<span class="dt">data =</span> milk,
                  <span class="dt">y =</span> <span class="st">"fat"</span>,
                  <span class="dt">x =</span> <span class="st">"arid"</span>)</code></pre></div>
<p><img src="Appendix-7-Robustness_check_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<p>The difference is significant judging by confidence interval coverage, but we know p-values are sensitive to heterogenity of variacnes.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ggpubr<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggpubr/topics/ggerrorplot">ggerrorplot</a></span>(<span class="dt">data =</span> milk,
                  <span class="dt">y =</span> <span class="st">"fat"</span>,
                  <span class="dt">x =</span> <span class="st">"arid"</span>,
                  <span class="dt">desc_stat =</span> <span class="st">"mean_ci"</span>)</code></pre></div>
<p><img src="Appendix-7-Robustness_check_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
</div>
</div>
<div id="model-arid-vs-non-arid" class="section level2">
<h2 class="hasAnchor">
<a href="#model-arid-vs-non-arid" class="anchor"></a>Model Arid vs. non-arid</h2>
<p>Select the rows of data we want</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">i.no &lt;-<span class="st"> </span><span class="kw">which</span>(milk<span class="op">$</span>arid <span class="op">==</span><span class="st"> "no"</span>)
i.yes &lt;-<span class="st"> </span><span class="kw">which</span>(milk<span class="op">$</span>arid <span class="op">==</span><span class="st"> "yes"</span>)

i.use &lt;-<span class="st"> </span><span class="kw">c</span>(i.no, i.yes)</code></pre></div>
<div id="regular-t-test" class="section level3">
<h3 class="hasAnchor">
<a href="#regular-t-test" class="anchor"></a>Regular t-test</h3>
<p>A regular t-test with no correction for heterogenous variances. Not recommended; just for comparison.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">t.test</span>(fat <span class="op">~</span><span class="st"> </span>arid, 
       <span class="dt">data =</span> milk[i.use,],
       <span class="dt">var.equal =</span> <span class="ot">TRUE</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;  Two Sample t-test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  fat by arid</span>
<span class="co">#&gt; t = 3.0493, df = 128, p-value = 0.002788</span>
<span class="co">#&gt; alternative hypothesis: true difference in means is not equal to 0</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;   2.825493 13.269013</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt;  mean in group no mean in group yes </span>
<span class="co">#&gt;         16.401099          8.353846</span></code></pre></div>
</div>
<div id="welchs-t-test" class="section level3">
<h3 class="hasAnchor">
<a href="#welchs-t-test" class="anchor"></a>Welch’s t-test</h3>
<p>The default t-test</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">t.test</span>(fat <span class="op">~</span><span class="st"> </span>arid, 
       <span class="dt">data =</span> milk[i.use,])
<span class="co">#&gt; </span>
<span class="co">#&gt;  Welch Two Sample t-test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  fat by arid</span>
<span class="co">#&gt; t = 4.0816, df = 127.95, p-value = 7.826e-05</span>
<span class="co">#&gt; alternative hypothesis: true difference in means is not equal to 0</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;   4.146069 11.948437</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt;  mean in group no mean in group yes </span>
<span class="co">#&gt;         16.401099          8.353846</span></code></pre></div>
</div>
<div id="logfat-w-regular-t-test" class="section level3">
<h3 class="hasAnchor">
<a href="#logfat-w-regular-t-test" class="anchor"></a>log(fat) w/ regular t-test</h3>
<p>Log transformation typically improves normality and equalizes variances.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">t.test</span>(<span class="kw">log</span>(fat) <span class="op">~</span><span class="st"> </span>arid, 
       <span class="dt">data =</span> milk[i.use,],
       <span class="dt">var.equal =</span> <span class="ot">TRUE</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;  Two Sample t-test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  log(fat) by arid</span>
<span class="co">#&gt; t = 2.6293, df = 128, p-value = 0.009605</span>
<span class="co">#&gt; alternative hypothesis: true difference in means is not equal to 0</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  0.1280392 0.9068536</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt;  mean in group no mean in group yes </span>
<span class="co">#&gt;          2.313444          1.795998</span></code></pre></div>
</div>
<div id="log-welchs-t-test" class="section level3">
<h3 class="hasAnchor">
<a href="#log-welchs-t-test" class="anchor"></a>log Welch’s t-test</h3>
<p>Welch’s test deals with variance, and log can perhaps help with normality.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">t.test</span>(<span class="kw">log</span>(fat) <span class="op">~</span><span class="st"> </span>arid, 
       <span class="dt">data =</span> milk[i.use,])
<span class="co">#&gt; </span>
<span class="co">#&gt;  Welch Two Sample t-test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  log(fat) by arid</span>
<span class="co">#&gt; t = 2.7734, df = 81.614, p-value = 0.006872</span>
<span class="co">#&gt; alternative hypothesis: true difference in means is not equal to 0</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  0.1462655 0.8886273</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt;  mean in group no mean in group yes </span>
<span class="co">#&gt;          2.313444          1.795998</span></code></pre></div>
</div>
<div id="rank-based-wilcox-test" class="section level3">
<h3 class="hasAnchor">
<a href="#rank-based-wilcox-test" class="anchor"></a>Rank-based Wilcox test</h3>
<p>When faced with non-normality the default approach was to use a non-parametric rank-based method. This has less power to detect differences because it throws away information</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">wilcox.test</span>(fat <span class="op">~</span><span class="st"> </span>arid, 
       <span class="dt">data =</span> milk[i.use,])
<span class="co">#&gt; </span>
<span class="co">#&gt;  Wilcoxon rank sum test with continuity correction</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  fat by arid</span>
<span class="co">#&gt; W = 2294, p-value = 0.008367</span>
<span class="co">#&gt; alternative hypothesis: true location shift is not equal to 0</span></code></pre></div>
</div>
<div id="linear-model" class="section level3">
<h3 class="hasAnchor">
<a href="#linear-model" class="anchor"></a>linear model</h3>
<p>Should be same as equal variance t-test</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m.lm &lt;-<span class="st"> </span><span class="kw">lm</span>(fat <span class="op">~</span><span class="st"> </span>arid, 
       <span class="dt">data =</span> milk[i.use,])

<span class="kw">coef</span>(<span class="kw">summary</span>(m.lm))
<span class="co">#&gt;              Estimate Std. Error   t value     Pr(&gt;|t|)</span>
<span class="co">#&gt; (Intercept) 16.401099   1.445453 11.346684 4.437894e-21</span>
<span class="co">#&gt; aridyes     -8.047253   2.639024 -3.049329 2.787795e-03</span></code></pre></div>
</div>
<div id="generalized-least-squares-gls" class="section level3">
<h3 class="hasAnchor">
<a href="#generalized-least-squares-gls" class="anchor"></a>generalized least squares (gls)</h3>
<p>The gls() function in the nlme package allows you to directly model heterogenity in variances. Instead of</p>
<ol style="list-style-type: decimal">
<li>Assuming variances in arid and non-arid mammals is equals, or (standard t-test; linear model)</li>
<li>Applying a black-box correction factor (Welch)</li>
</ol>
<p>You can incorporate the observed variances into the model. NOte the line</p>
<ul>
<li>weights = varIdent(form = ~1 | arid)</li>
</ul>
<p>This is a function varIdent(), which has a form inside it (“form”) that says “allow the variance to be different between the two arid and non-arid groups”</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m.gls.var &lt;-<span class="st"> </span><span class="kw">gls</span>(fat <span class="op">~</span><span class="st"> </span>arid, 
       <span class="dt">data =</span> milk[i.use,],
       <span class="dt">weights =</span> <span class="kw">varIdent</span>(<span class="dt">form =</span> <span class="op">~</span><span class="dv">1</span> <span class="op">|</span><span class="st"> </span>arid))

<span class="kw">coef</span>(<span class="kw">summary</span>(m.gls.var))
<span class="co">#&gt;                 Value Std.Error   t-value      p-value</span>
<span class="co">#&gt; (Intercept) 16.401099  1.664086  9.855923 2.139350e-17</span>
<span class="co">#&gt; aridyes     -8.047253  1.971611 -4.081563 7.823907e-05</span></code></pre></div>
<p>Removing the varIdent bit will give you the same results as lm()</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m.gls.no.var &lt;-<span class="st"> </span>nlme<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/nlme/topics/gls">gls</a></span>(fat <span class="op">~</span><span class="st"> </span>arid, 
       <span class="dt">data =</span> milk[i.use,])</code></pre></div>
<p>We can compare the fit of these models using AIC. dAIC is &gt;28, indicating that the model which incorporates heterogenous variance is much better.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">AICtab</span>(m.gls.var,
       m.gls.no.var)
<span class="co">#&gt;              dAIC df</span>
<span class="co">#&gt; m.gls.var     0.0 4 </span>
<span class="co">#&gt; m.gls.no.var 28.6 3</span></code></pre></div>
</div>
</div>
<div id="experiment-wide-p-value-corrections" class="section level2">
<h2 class="hasAnchor">
<a href="#experiment-wide-p-value-corrections" class="anchor"></a>Experiment-wide p-value corrections</h2>
<p>The data set has reponse (x) variables of fat, protein, sugar, and total energy. What if we did t-test on all of these?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p.fat &lt;-<span class="st"> </span><span class="kw">t.test</span>(fat <span class="op">~</span><span class="st"> </span>arid, 
       <span class="dt">data =</span> milk[i.use,])<span class="op">$</span>p.value

p.protein &lt;-<span class="st"> </span><span class="kw">t.test</span>(prot <span class="op">~</span><span class="st"> </span>arid, 
       <span class="dt">data =</span> milk[i.use,])<span class="op">$</span>p.value

p.sugar &lt;-<span class="st"> </span><span class="kw">t.test</span>(sugar <span class="op">~</span><span class="st"> </span>arid, 
       <span class="dt">data =</span> milk[i.use,])<span class="op">$</span>p.value

p.energy &lt;-<span class="st"> </span><span class="kw">t.test</span>(energy <span class="op">~</span><span class="st"> </span>arid, 
       <span class="dt">data =</span> milk[i.use,])<span class="op">$</span>p.value</code></pre></div>
<p>These p-values vary a lot</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p.fat
<span class="co">#&gt; [1] 7.825563e-05</span>
p.protein
<span class="co">#&gt; [1] 0.322755</span>
p.sugar
<span class="co">#&gt; [1] 0.1491977</span>
p.energy
<span class="co">#&gt; [1] 0.01841994</span></code></pre></div>
<p>The arguement could be made that you should correct for multiple comparions (I wouldn’t necessarily argue for it myself). Things like Tukey’s-HSD correct for the <strong>family-wise</strong> error rate for related hypothesis tests within the same model. If we wanted to correct our five p-values above we’d we doing more of an <strong>experiment-wise</strong> error correction, though the application of these terms might vary.</p>
<p>Regardless of what you call it, you want to correct p-values originating from different models. You can do this using <strong>p.adjust()</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">the.ps &lt;-<span class="st"> </span><span class="kw">c</span>(p.fat,p.protein,p.sugar,p.energy)</code></pre></div>
<p>A Bonfoerroni correction is a conservation approach which actually has too stiff of a penalty; it leaves jsut on value “significant” (but 0.074 is pretty close)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">p.adjust</span>(the.ps,<span class="dt">method =</span> <span class="st">"bonferroni"</span>)
<span class="co">#&gt; [1] 0.0003130225 1.0000000000 0.5967906641 0.0736797528</span></code></pre></div>
<p>the Holm method is Rs default for p.adjust and other functions which use p.adjust. It is less conservative than Bonferronni and does a better job of keeping alpha at the desired level. THe math is similar to Bonferonni but has some extra steps so I think many people use Bonf instead if they are doing calculations by hand.</p>
<p>The Holm method moves the last p-value in the list closer to 0.05 (of course, you shouldn’t get hung up on 0.05, but many people do.)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">p.adjust</span>(the.ps,<span class="dt">method =</span> <span class="st">"holm"</span>)
<span class="co">#&gt; [1] 0.0003130225 0.3227550261 0.2983953320 0.0552598146</span></code></pre></div>
<p>The <strong>false discovery rate</strong> is becoming popular in some fields. It takes a different goal for what frequency of errors to let occur and is generally less stringent the Bonferroni, Holm, and related methods The last p-value is now 0.037. (Again, a little above 0.05 and a little below 0.05 shouldn’t be treated definitely as anythign)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">p.adjust</span>(the.ps,<span class="dt">method =</span> <span class="st">"fdr"</span>)
<span class="co">#&gt; [1] 0.0003130225 0.3227550261 0.1989302214 0.0368398764</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#preliminaries">Preliminaries</a></li>
      <li><a href="#model-arid-vs-non-arid">Model Arid vs. non-arid</a></li>
      <li><a href="#experiment-wide-p-value-corrections">Experiment-wide p-value corrections</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by First Last.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
