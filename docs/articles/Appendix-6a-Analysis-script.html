<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Analysis • mammalsmilkRA</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Analysis">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mammalsmilkRA</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Appendix-4a-Grapical_Exploratory_Analyses.html">Appendix 4a: Graphical Exploratory Analysis</a>
    </li>
    <li>
      <a href="../articles/Appendix-4b-Numeric_Exploratory_Analyses.html">Appendix 4b: Numeric Summaries &amp; Exploratory Analysis</a>
    </li>
    <li>
      <a href="../articles/Appendix-5-study_diagram.html">Appendix 5: Study Diagrams</a>
    </li>
    <li>
      <a href="../articles/Appendix-6a-Analysis-script.html">Analysis</a>
    </li>
    <li>
      <a href="../articles/Appendix-6b-Model-diagnostics.html">Appendix 6b: Model diagnostics</a>
    </li>
    <li>
      <a href="../articles/f-faq.html">f) Frequently asked questions</a>
    </li>
    <li>
      <a href="../articles/r-references.html">r) References</a>
    </li>
    <li>
      <a href="../articles/y-build_and_rebuild_package.html">z) Building and rebuilding vignettes</a>
    </li>
    <li>
      <a href="../articles/z-creating_the_package.html">z) Creating this package</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Analysis</h1>
                        <h4 class="author">Vignette Author</h4>
            
            <h4 class="date">2018-11-28</h4>
      
      
      <div class="hidden name"><code>Appendix-6a-Analysis-script.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>This script implements my re-analysis of the Skibiel et al mammals’ milk dataset. Skibiel et al made the unconventional but well supported conclusion that there was not a relationship between body size and nutrional content of milk, including fat content. The note, however, that some groups might have a relationship, while others might not, but on the whole there was no relationship between body size and fat. Most variation in nutrional content was therefore due to differences in evolutionary history and not body size senu stricto.</p>
<p>I take a model comparison approach using AICc to compare models similar to what Skibiel concluded best fit the data (fat ~ diet) with one that allows the relationship between fat and body size to vary between groups of organisms.</p>
<p>Like Skibiel I find a very strong phylogentic signal on fat content of milk. I use this phyolgeny-only model as my null model. Allowing fat content to vary differently with body size between different groups fits the data slightly better than the null model, but this difference is only a delta AICc (dAICc) of 1.4. Surprisingly, a model which includes diet doesn’t perform as well as null model, which contradicts Skibiel et al. This difference in results is likely due to my use of random effets to represent taxonomic structure (species nested within genera, genera within families, families within orders) rather than a precise phylogeny.</p>
</div>
<div id="preliminaries" class="section level2">
<h2 class="hasAnchor">
<a href="#preliminaries" class="anchor"></a>Preliminaries</h2>
<div id="load-packages" class="section level3">
<h3 class="hasAnchor">
<a href="#load-packages" class="anchor"></a>Load packages</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)  <span class="co"># for exploratory analyses</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'dplyr'</span>
<span class="co">#&gt; The following objects are masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     filter, lag</span>
<span class="co">#&gt; The following objects are masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     intersect, setdiff, setequal, union</span>
<span class="kw">library</span>(ggpubr) <span class="co"># plotting using ggplto2</span>
<span class="co">#&gt; Loading required package: ggplot2</span>
<span class="co">#&gt; Loading required package: magrittr</span>
<span class="kw">library</span>(cowplot)
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'cowplot'</span>
<span class="co">#&gt; The following object is masked from 'package:ggpubr':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     get_legend</span>
<span class="co">#&gt; The following object is masked from 'package:ggplot2':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     ggsave</span>
<span class="kw">library</span>(lme4)
<span class="co">#&gt; Loading required package: Matrix</span>
<span class="kw">library</span>(arm)
<span class="co">#&gt; Loading required package: MASS</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'MASS'</span>
<span class="co">#&gt; The following object is masked from 'package:dplyr':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     select</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; arm (Version 1.10-1, built: 2018-4-12)</span>
<span class="co">#&gt; Working directory is C:/Users/lisanjie/Documents/1_R/git/mammalsmilkRA/vignettes</span>
<span class="kw">library</span>(stringr) 
<span class="kw">library</span>(bbmle)
<span class="co">#&gt; Loading required package: stats4</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'bbmle'</span>
<span class="co">#&gt; The following object is masked from 'package:dplyr':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     slice</span>
<span class="kw">library</span>(plotrix) ##std.error function for SE
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'plotrix'</span>
<span class="co">#&gt; The following object is masked from 'package:arm':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     rescale</span>
<span class="kw">library</span>(psych)
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'psych'</span>
<span class="co">#&gt; The following object is masked from 'package:plotrix':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     rescale</span>
<span class="co">#&gt; The following objects are masked from 'package:arm':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     logit, rescale, sim</span>
<span class="co">#&gt; The following objects are masked from 'package:ggplot2':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     %+%, alpha</span>
<span class="kw">library</span>(here)
<span class="co">#&gt; here() starts at C:/Users/lisanjie/Documents/1_R/git/mammalsmilkRA</span></code></pre></div>
</div>
<div id="load-data-in-r" class="section level3">
<h3 class="hasAnchor">
<a href="#load-data-in-r" class="anchor"></a>Load data in R</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">file. &lt;-<span class="st"> "Appendix-2-Analysis-Data_mammalsmilkRA.csv"</span>
path. &lt;-<span class="st"> </span><span class="kw">here</span>(<span class="st">"/inst/extdata/"</span>,file.)

milk &lt;-<span class="st"> </span><span class="kw">read.csv</span>(path., <span class="dt">skip =</span> <span class="dv">3</span>)</code></pre></div>
</div>
<div id="check-input" class="section level3">
<h3 class="hasAnchor">
<a href="#check-input" class="anchor"></a>Check input</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(milk)
<span class="co">#&gt;            ord     fam                            spp mass.fem gest.mo</span>
<span class="co">#&gt; 1 Artiodactyla Bovidae                  Bos frontalis   800000    9.02</span>
<span class="co">#&gt; 2 Artiodactyla Bovidae                     Capra ibex    53000    5.60</span>
<span class="co">#&gt; 3 Artiodactyla Bovidae Connocheates taurinus taurinus   170500    8.32</span>
<span class="co">#&gt; 4 Artiodactyla Bovidae              Connocheates gnou   200000    8.50</span>
<span class="co">#&gt; 5 Artiodactyla Bovidae  Damaliscus pygargus phillipsi    61000    8.00</span>
<span class="co">#&gt; 6 Artiodactyla Bovidae                 Gazella dorcas    20600    4.74</span>
<span class="co">#&gt;   lac.mo mass.litter repro.output dev.birth      diet arid       biome  N</span>
<span class="co">#&gt; 1    4.5       26949         0.03         3 herbivore   no terrestrial 4+</span>
<span class="co">#&gt; 2    7.5        3489         0.07         3 herbivore   no terrestrial 24</span>
<span class="co">#&gt; 3    8.0       17717         0.10         3 herbivore  yes terrestrial  5</span>
<span class="co">#&gt; 4    7.5       11110         0.06         3 herbivore  yes terrestrial  3</span>
<span class="co">#&gt; 5    4.0        6500         0.11         3 herbivore  yes terrestrial  4</span>
<span class="co">#&gt; 6    2.8        1771         0.09         3 herbivore  yes terrestrial 16</span>
<span class="co">#&gt;    fat gest.month lacat.mo prot sugar energy</span>
<span class="co">#&gt; 1  7.0       9.02      4.5  6.3   5.2   1.21</span>
<span class="co">#&gt; 2 12.4       5.60      7.5  5.7    NA     NA</span>
<span class="co">#&gt; 3  7.5       8.32      8.0  4.1   5.3   1.13</span>
<span class="co">#&gt; 4  5.5       8.50      7.5  4.3   4.1   0.91</span>
<span class="co">#&gt; 5  8.6       8.00      4.0  5.6   4.9   1.31</span>
<span class="co">#&gt; 6  8.8       4.74      2.8  8.8    NA     NA</span>
<span class="kw">tail</span>(milk)
<span class="co">#&gt;                ord          fam                     spp mass.fem gest.mo</span>
<span class="co">#&gt; 125       Rodentia      Muridae     Pseudomys australis       65    1.02</span>
<span class="co">#&gt; 126       Rodentia      Muridae       Rattus norvegicus      253    0.71</span>
<span class="co">#&gt; 127       Rodentia Octodontidae           Octodon degus      235    2.96</span>
<span class="co">#&gt; 128       Rodentia    Scuiridae          Tamias amoenus       53    0.98</span>
<span class="co">#&gt; 129       Rodentia    Scuiridae Urocitellus columbianus      406    0.84</span>
<span class="co">#&gt; 130 Soricomorpha11    Soricidae       Crocidura russula       14    0.97</span>
<span class="co">#&gt;     lac.mo mass.litter repro.output dev.birth      diet arid       biome</span>
<span class="co">#&gt; 125    0.9          13         0.20         0 herbivore  yes terrestrial</span>
<span class="co">#&gt; 126    0.8          51         0.20         0  omnivore   no terrestrial</span>
<span class="co">#&gt; 127    1.2          74         0.31         3 herbivore  yes terrestrial</span>
<span class="co">#&gt; 128    1.5          14         0.26         0  omnivore   no terrestrial</span>
<span class="co">#&gt; 129    1.0          32         0.08         0 herbivore   no terrestrial</span>
<span class="co">#&gt; 130    0.8           4         0.29         0 carnivore   no terrestrial</span>
<span class="co">#&gt;          N  fat gest.month lacat.mo prot sugar energy</span>
<span class="co">#&gt; 125  7-Jun 12.1       1.02      0.9  6.4   3.6   1.62</span>
<span class="co">#&gt; 126 18-Mar  8.8       0.71      0.8  8.1   3.8   1.43</span>
<span class="co">#&gt; 127      7 20.1       2.96      1.2  4.4   2.7   2.20</span>
<span class="co">#&gt; 128     11 21.7       0.98      1.5  8.1   4.3   2.62</span>
<span class="co">#&gt; 129     26  9.2       0.84      1.0 10.7   3.4   1.60</span>
<span class="co">#&gt; 130      3 30.0       0.97      0.8  9.4   3.0   3.40</span>
<span class="kw">summary</span>(milk)
<span class="co">#&gt;             ord                  fam                          spp     </span>
<span class="co">#&gt;  Artiodactyla :23   Bovidae        :13   Acomys cahirinus       :  1  </span>
<span class="co">#&gt;  Carnivora    :23   Cercopithecidae: 8   Alces alces            :  1  </span>
<span class="co">#&gt;  Primates     :22   Cervidae       : 7   Aloutta palliata       :  1  </span>
<span class="co">#&gt;  Rodentia     :17   Muridae        : 7   Aloutta seniculus      :  1  </span>
<span class="co">#&gt;  Chiroptera   :10   Otariidae      : 7   Arctocephalus australis:  1  </span>
<span class="co">#&gt;  Diprotodontia:10   Phocidae       : 7   Arctocephalus gazella  :  1  </span>
<span class="co">#&gt;  (Other)      :25   (Other)        :81   (Other)                :124  </span>
<span class="co">#&gt;     mass.fem            gest.mo           lac.mo        mass.litter       </span>
<span class="co">#&gt;  Min.   :        8   Min.   : 0.400   Min.   : 0.300   Min.   :      0.3  </span>
<span class="co">#&gt;  1st Qu.:      857   1st Qu.: 1.405   1st Qu.: 1.625   1st Qu.:     42.0  </span>
<span class="co">#&gt;  Median :     5716   Median : 5.000   Median : 4.500   Median :    423.5  </span>
<span class="co">#&gt;  Mean   :  2229475   Mean   : 5.624   Mean   : 6.092   Mean   :  52563.8  </span>
<span class="co">#&gt;  3rd Qu.:   107500   3rd Qu.: 8.365   3rd Qu.: 8.225   3rd Qu.:   7038.2  </span>
<span class="co">#&gt;  Max.   :170000000   Max.   :21.460   Max.   :42.000   Max.   :2272500.0  </span>
<span class="co">#&gt;                                                                           </span>
<span class="co">#&gt;   repro.output       dev.birth            diet     arid   </span>
<span class="co">#&gt;  Min.   :0.00003   Min.   :0.000   carnivore:32   no :91  </span>
<span class="co">#&gt;  1st Qu.:0.04000   1st Qu.:1.000   herbivore:61   yes:39  </span>
<span class="co">#&gt;  Median :0.08000   Median :2.000   omnivore :37           </span>
<span class="co">#&gt;  Mean   :0.10374   Mean   :1.831                          </span>
<span class="co">#&gt;  3rd Qu.:0.13750   3rd Qu.:3.000                          </span>
<span class="co">#&gt;  Max.   :0.50000   Max.   :4.000                          </span>
<span class="co">#&gt;                                                           </span>
<span class="co">#&gt;          biome           N           fat          gest.month    </span>
<span class="co">#&gt;  aquatic    : 22   4      :13   Min.   : 0.20   Min.   : 0.400  </span>
<span class="co">#&gt;  terrestrial:108   3      :11   1st Qu.: 4.65   1st Qu.: 1.405  </span>
<span class="co">#&gt;                    6      :10   Median : 8.55   Median : 5.000  </span>
<span class="co">#&gt;                    7      : 9   Mean   :13.99   Mean   : 5.624  </span>
<span class="co">#&gt;                    5      : 8   3rd Qu.:16.82   3rd Qu.: 8.365  </span>
<span class="co">#&gt;                    24     : 5   Max.   :61.10   Max.   :21.460  </span>
<span class="co">#&gt;                    (Other):74                                   </span>
<span class="co">#&gt;     lacat.mo           prot            sugar           energy     </span>
<span class="co">#&gt;  Min.   : 0.300   Min.   : 1.100   Min.   : 0.02   Min.   :0.360  </span>
<span class="co">#&gt;  1st Qu.: 1.625   1st Qu.: 4.125   1st Qu.: 3.00   1st Qu.:0.965  </span>
<span class="co">#&gt;  Median : 4.500   Median : 6.750   Median : 4.70   Median :1.365  </span>
<span class="co">#&gt;  Mean   : 6.092   Mean   : 6.673   Mean   : 4.94   Mean   :1.680  </span>
<span class="co">#&gt;  3rd Qu.: 8.225   3rd Qu.: 9.200   3rd Qu.: 6.60   3rd Qu.:2.045  </span>
<span class="co">#&gt;  Max.   :42.000   Max.   :15.800   Max.   :14.00   Max.   :5.890  </span>
<span class="co">#&gt;                                    NA's   :16      NA's   :16</span></code></pre></div>
</div>
<div id="data-cleaning" class="section level3">
<h3 class="hasAnchor">
<a href="#data-cleaning" class="anchor"></a>Data cleaning</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">genus_spp_subspp_mat &lt;-<span class="st"> </span>milk<span class="op">$</span>spp <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">str_split_fixed</span>(<span class="st">" "</span>, <span class="dt">n =</span> <span class="dv">3</span>)

milk<span class="op">$</span>genus &lt;-<span class="st"> </span>genus_spp_subspp_mat[,<span class="dv">1</span>]</code></pre></div>
</div>
<div id="transformation" class="section level3">
<h3 class="hasAnchor">
<a href="#transformation" class="anchor"></a>Transformation</h3>
<p>I generally prefer to make sure all of my transformations are represented in my “analysis data”, but I have not yet updated that file yet.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">milk<span class="op">$</span>fat.log10 &lt;-<span class="st"> </span><span class="kw">log10</span>(milk<span class="op">$</span>fat)
milk<span class="op">$</span>mass.fem.log10 &lt;-<span class="st"> </span><span class="kw">log10</span>(milk<span class="op">$</span>mass.fem)</code></pre></div>
</div>
<div id="create-aggregate-predictor" class="section level3">
<h3 class="hasAnchor">
<a href="#create-aggregate-predictor" class="anchor"></a>Create aggregate predictor</h3>
<p>All aquatic mammals in the dataset are carnviores</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">with</span>(milk, 
     <span class="kw">table</span>(biome, 
           diet))
<span class="co">#&gt;              diet</span>
<span class="co">#&gt; biome         carnivore herbivore omnivore</span>
<span class="co">#&gt;   aquatic            22         0        0</span>
<span class="co">#&gt;   terrestrial        10        61       37</span></code></pre></div>
<p>I am going to make a new categorical variable with 4 levels which combines the 3 levels of diet with the 2 levels of biome.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">milk<span class="op">$</span>biome.diet &lt;-<span class="st"> </span><span class="kw">paste</span>(milk<span class="op">$</span>biome,
                         milk<span class="op">$</span>diet,
                         <span class="dt">sep =</span> <span class="st">"-"</span>)

<span class="kw">summary</span>(<span class="kw">factor</span>(milk<span class="op">$</span>biome.diet))
<span class="co">#&gt;     aquatic-carnivore terrestrial-carnivore terrestrial-herbivore </span>
<span class="co">#&gt;                    22                    10                    61 </span>
<span class="co">#&gt;  terrestrial-omnivore </span>
<span class="co">#&gt;                    37</span></code></pre></div>
</div>
<div id="delineate-subset-for-analysis" class="section level3">
<h3 class="hasAnchor">
<a href="#delineate-subset-for-analysis" class="anchor"></a>Delineate subset for analysis</h3>
<p>Summarize order by number of animals in each group</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">orders &lt;-<span class="st"> </span>milk <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(ord) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">order.N =</span> <span class="kw">n</span>())</code></pre></div>
<p>For the model I want to run, I need at least 3 data points (species) per group (order)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggdotchart</span>(<span class="dt">data =</span> orders,
           <span class="dt">x =</span> <span class="st">"ord"</span>,
           <span class="dt">y =</span> <span class="st">"order.N"</span>,
           <span class="dt">add =</span> <span class="st">"segment"</span>,
           <span class="dt">ylab =</span> <span class="st">"Number of species"</span>,
           <span class="dt">xlab =</span> <span class="st">"Taxonomic order"</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">3</span>)</code></pre></div>
<p><img src="Appendix-6a-Analysis-script_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<p>I will code each specis as being a member of an order w/ greater than 2 (“use”) or less than 2 species (“drop”)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">orders<span class="op">$</span>order.N.<span class="fl">3.</span>plus &lt;-<span class="st"> </span><span class="kw">ifelse</span>(orders<span class="op">$</span>order.N <span class="op">&gt;</span><span class="dv">2</span>,
                                <span class="st">"use"</span>,
                                <span class="st">"drop"</span>)</code></pre></div>
<p>I’ll then merge this summary dataframe orders into the big dataframe</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">milk2 &lt;-<span class="st"> </span><span class="kw">merge</span>(milk,orders)
<span class="kw">dim</span>(milk)
<span class="co">#&gt; [1] 130  23</span>
<span class="kw">dim</span>(milk2)
<span class="co">#&gt; [1] 130  25</span></code></pre></div>
<p>Then I’ll select just the rows which can be used.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
i.use &lt;-<span class="st"> </span><span class="kw">which</span>(milk2<span class="op">$</span>order.N.<span class="fl">3.</span>plus <span class="op">==</span><span class="st"> "use"</span>)

milk.working &lt;-<span class="st"> </span>milk2[i.use, ]</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">milk.working[<span class="kw">which</span>(milk.working<span class="op">$</span>fat.log10 <span class="op">&lt;</span><span class="fl">0.5</span>), ]
<span class="co">#&gt;                 ord              fam                       spp mass.fem</span>
<span class="co">#&gt; 60       Chiroptera     Pteropodidae    Pteropus poliocephalus      800</span>
<span class="co">#&gt; 73    Diprotodontia      Potoroidae7      Potorous tridactylus     1047</span>
<span class="co">#&gt; 74    Diprotodontia Pseudocheiridae8  Pseudocheirus peregrinus      910</span>
<span class="co">#&gt; 82  Perrissodactyla          Equidae              Equus asinus   250000</span>
<span class="co">#&gt; 83  Perrissodactyla          Equidae          Equus burchellii   276000</span>
<span class="co">#&gt; 84  Perrissodactyla          Equidae   Equus ferus przewalskii   250000</span>
<span class="co">#&gt; 85  Perrissodactyla          Equidae               Equus zebra   262000</span>
<span class="co">#&gt; 86  Perrissodactyla   Rhinocerotidae          Diceros bicornis   884000</span>
<span class="co">#&gt; 87  Perrissodactyla        Tapiridae           Tapirus bairdii   300000</span>
<span class="co">#&gt; 89         Primates       Atelidae12         Aloutta seniculus     5390</span>
<span class="co">#&gt; 90         Primates       Atelidae12          Aloutta palliata     6400</span>
<span class="co">#&gt; 94         Primates  Cercopithecidae   Chlorocebus pygerythrus     5750</span>
<span class="co">#&gt; 98         Primates  Cercopithecidae      Miopithecus talapoin     1120</span>
<span class="co">#&gt; 104        Primates        Hominidae Gorilla beringei beringei    90000</span>
<span class="co">#&gt; 105        Primates        Lemuridae            Eulemur fulvus     2500</span>
<span class="co">#&gt; 106        Primates        Lemuridae            Eulemur macaco     2250</span>
<span class="co">#&gt; 107        Primates        Lemuridae       Eulemur rubriventer     2000</span>
<span class="co">#&gt; 108        Primates        Lemuridae            Eulemur mongoz     1350</span>
<span class="co">#&gt;     gest.mo lac.mo mass.litter repro.output dev.birth      diet arid</span>
<span class="co">#&gt; 60     6.00    5.5        69.0       0.0900         2 herbivore   no</span>
<span class="co">#&gt; 73     1.27    1.4         0.3       0.0003         0  omnivore  yes</span>
<span class="co">#&gt; 74     3.50    7.3         0.6       0.0007         0 herbivore   no</span>
<span class="co">#&gt; 82    11.97   13.0     29167.0       0.1200         3 herbivore  yes</span>
<span class="co">#&gt; 83    12.16   10.8     32292.0       0.1200         3 herbivore  yes</span>
<span class="co">#&gt; 84    11.50   10.5     30000.0       0.1200         3 herbivore  yes</span>
<span class="co">#&gt; 85    12.02   10.0     30000.0       0.0100         3 herbivore  yes</span>
<span class="co">#&gt; 86    16.12   19.9     34167.0       0.0400         2 herbivore  yes</span>
<span class="co">#&gt; 87    13.17   12.0      9400.0       0.0300         3 herbivore   no</span>
<span class="co">#&gt; 89     6.37   12.3       354.0       0.0700         2 herbivore   no</span>
<span class="co">#&gt; 90     6.22   14.2       369.0       0.0600         2 herbivore   no</span>
<span class="co">#&gt; 94     5.50    8.5       318.0       0.0600         2  omnivore   no</span>
<span class="co">#&gt; 98     5.40    5.4       188.0       0.1700         2  omnivore   no</span>
<span class="co">#&gt; 104    8.50   42.0      1600.0       0.0200         2 herbivore   no</span>
<span class="co">#&gt; 105    4.02    5.0        85.0       0.0300         2  omnivore   no</span>
<span class="co">#&gt; 106    4.37    5.2        79.0       0.0400         2  omnivore   no</span>
<span class="co">#&gt; 107    4.28    3.3        86.0       0.0400         2  omnivore   no</span>
<span class="co">#&gt; 108    4.29    5.1        71.0       0.0500         2  omnivore   no</span>
<span class="co">#&gt;           biome     N fat gest.month lacat.mo prot sugar energy</span>
<span class="co">#&gt; 60  terrestrial    31 2.0       6.00      5.5  2.5   6.2   0.57</span>
<span class="co">#&gt; 73  terrestrial 5-Mar 3.0       1.27      1.4 10.0  14.0   1.41</span>
<span class="co">#&gt; 74  terrestrial    &gt;8 3.0       3.50      7.3  4.5  12.5   1.03</span>
<span class="co">#&gt; 82  terrestrial     9 1.8      11.97     13.0  1.7   5.9   0.50</span>
<span class="co">#&gt; 83  terrestrial     5 2.2      12.16     10.8  1.6   7.0   0.57</span>
<span class="co">#&gt; 84  terrestrial    14 1.5      11.50     10.5  1.6   6.7   0.50</span>
<span class="co">#&gt; 85  terrestrial     7 1.0      12.02     10.0  1.6   6.9   0.46</span>
<span class="co">#&gt; 86  terrestrial    11 0.2      16.12     19.9  1.4   6.6   0.36</span>
<span class="co">#&gt; 87  terrestrial     4 1.9      13.17     12.0  4.6   5.3   0.65</span>
<span class="co">#&gt; 89  terrestrial     7 1.1       6.37     12.3  1.9   6.6   0.47</span>
<span class="co">#&gt; 90  terrestrial     7 1.6       6.22     14.2  2.2   6.7   0.54</span>
<span class="co">#&gt; 94  terrestrial     4 3.1       5.50      8.5  1.6   8.5   0.71</span>
<span class="co">#&gt; 98  terrestrial     4 3.0       5.40      5.4  2.1   7.2   0.68</span>
<span class="co">#&gt; 104 terrestrial     7 1.9       8.50     42.0  1.4   6.8   0.52</span>
<span class="co">#&gt; 105 terrestrial     6 0.9       4.02      5.0  1.3   8.5   0.49</span>
<span class="co">#&gt; 106 terrestrial     7 1.1       4.37      5.2  1.5   8.4   0.52</span>
<span class="co">#&gt; 107 terrestrial     3 0.8       4.28      3.3  1.1   8.9   0.49</span>
<span class="co">#&gt; 108 terrestrial     4 0.7       4.29      5.1  1.3   7.9   0.45</span>
<span class="co">#&gt;             genus   fat.log10 mass.fem.log10            biome.diet order.N</span>
<span class="co">#&gt; 60       Pteropus  0.30103000       2.903090 terrestrial-herbivore      10</span>
<span class="co">#&gt; 73       Potorous  0.47712125       3.019947  terrestrial-omnivore      10</span>
<span class="co">#&gt; 74  Pseudocheirus  0.47712125       2.959041 terrestrial-herbivore      10</span>
<span class="co">#&gt; 82          Equus  0.25527251       5.397940 terrestrial-herbivore       7</span>
<span class="co">#&gt; 83          Equus  0.34242268       5.440909 terrestrial-herbivore       7</span>
<span class="co">#&gt; 84          Equus  0.17609126       5.397940 terrestrial-herbivore       7</span>
<span class="co">#&gt; 85          Equus  0.00000000       5.418301 terrestrial-herbivore       7</span>
<span class="co">#&gt; 86        Diceros -0.69897000       5.946452 terrestrial-herbivore       7</span>
<span class="co">#&gt; 87        Tapirus  0.27875360       5.477121 terrestrial-herbivore       7</span>
<span class="co">#&gt; 89        Aloutta  0.04139269       3.731589 terrestrial-herbivore      22</span>
<span class="co">#&gt; 90        Aloutta  0.20411998       3.806180 terrestrial-herbivore      22</span>
<span class="co">#&gt; 94    Chlorocebus  0.49136169       3.759668  terrestrial-omnivore      22</span>
<span class="co">#&gt; 98    Miopithecus  0.47712125       3.049218  terrestrial-omnivore      22</span>
<span class="co">#&gt; 104       Gorilla  0.27875360       4.954243 terrestrial-herbivore      22</span>
<span class="co">#&gt; 105       Eulemur -0.04575749       3.397940  terrestrial-omnivore      22</span>
<span class="co">#&gt; 106       Eulemur  0.04139269       3.352183  terrestrial-omnivore      22</span>
<span class="co">#&gt; 107       Eulemur -0.09691001       3.301030  terrestrial-omnivore      22</span>
<span class="co">#&gt; 108       Eulemur -0.15490196       3.130334  terrestrial-omnivore      22</span>
<span class="co">#&gt;     order.N.3.plus</span>
<span class="co">#&gt; 60             use</span>
<span class="co">#&gt; 73             use</span>
<span class="co">#&gt; 74             use</span>
<span class="co">#&gt; 82             use</span>
<span class="co">#&gt; 83             use</span>
<span class="co">#&gt; 84             use</span>
<span class="co">#&gt; 85             use</span>
<span class="co">#&gt; 86             use</span>
<span class="co">#&gt; 87             use</span>
<span class="co">#&gt; 89             use</span>
<span class="co">#&gt; 90             use</span>
<span class="co">#&gt; 94             use</span>
<span class="co">#&gt; 98             use</span>
<span class="co">#&gt; 104            use</span>
<span class="co">#&gt; 105            use</span>
<span class="co">#&gt; 106            use</span>
<span class="co">#&gt; 107            use</span>
<span class="co">#&gt; 108            use</span></code></pre></div>
</div>
<div id="visualize-data" class="section level3">
<h3 class="hasAnchor">
<a href="#visualize-data" class="anchor"></a>Visualize data</h3>
<p>Not that scales are variable for each panel for both axes</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">ggscatter</span>(<span class="dt">data =</span> milk.working,
       <span class="dt">y =</span> <span class="st">"fat.log10"</span>,
       <span class="dt">x =</span> <span class="st">"mass.fem.log10"</span>,
       <span class="dt">add =</span> <span class="st">"reg.line"</span>,
       <span class="dt">color =</span> <span class="st">"biome"</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_wrap</span>(.<span class="op">~</span>ord,<span class="dt">scales =</span> <span class="st">"free"</span>)</code></pre></div>
<p><img src="Appendix-6a-Analysis-script_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
</div>
</div>
<div id="build-model" class="section level2">
<h2 class="hasAnchor">
<a href="#build-model" class="anchor"></a>Build model</h2>
<div id="null-model" class="section level3">
<h3 class="hasAnchor">
<a href="#null-model" class="anchor"></a>Null model</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m.null &lt;-<span class="st"> </span><span class="kw">lmer</span>(fat.log10 <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span>
<span class="st">                 </span>(<span class="dv">1</span><span class="op">|</span>ord) <span class="op">+</span>
<span class="st">                 </span>(<span class="dv">1</span><span class="op">|</span>fam) <span class="op">+</span>
<span class="st">                 </span>(<span class="dv">1</span><span class="op">|</span>genus),
      <span class="dt">data =</span> milk.working)</code></pre></div>
</div>
<div id="mass-model" class="section level3">
<h3 class="hasAnchor">
<a href="#mass-model" class="anchor"></a>Mass model</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m.mass &lt;-<span class="st"> </span><span class="kw">update</span>(m.null, 
                 . <span class="op">~</span><span class="st"> </span>. <span class="op">+</span><span class="st"> </span>mass.fem.log10)</code></pre></div>
</div>
<div id="diet-model" class="section level3">
<h3 class="hasAnchor">
<a href="#diet-model" class="anchor"></a>Diet model</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m.diet &lt;-<span class="st"> </span><span class="kw">update</span>(m.null, 
                 . <span class="op">~</span><span class="st"> </span>. <span class="op">+</span><span class="st"> </span>diet)</code></pre></div>
</div>
<div id="diffrent-slopes-for-each-order" class="section level3">
<h3 class="hasAnchor">
<a href="#diffrent-slopes-for-each-order" class="anchor"></a>Diffrent slopes for each order</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m.slopes &lt;-<span class="st"> </span><span class="kw">lmer</span>(fat.log10 <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span>
<span class="st">                 </span>(mass.fem.log10<span class="op">|</span>ord) <span class="op">+</span>
<span class="st">                 </span>(<span class="dv">1</span><span class="op">|</span>fam) <span class="op">+</span>
<span class="st">                 </span>(<span class="dv">1</span><span class="op">|</span>genus),
      <span class="dt">data =</span> milk.working)</code></pre></div>
</div>
<div id="diffrent-slopes-for-each-order-plus-diet" class="section level3">
<h3 class="hasAnchor">
<a href="#diffrent-slopes-for-each-order-plus-diet" class="anchor"></a>Diffrent slopes for each order plus diet</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m.slopes.diet &lt;-<span class="st"> </span><span class="kw">update</span>(m.slopes, 
                   . <span class="op">~</span><span class="st"> </span>. <span class="op">+</span><span class="st"> </span>diet)</code></pre></div>
</div>
<div id="diffrent-slopes-for-each-order-x-diet" class="section level3">
<h3 class="hasAnchor">
<a href="#diffrent-slopes-for-each-order-x-diet" class="anchor"></a>Diffrent slopes for each order x diet</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m.slopes.x.diet &lt;-<span class="st"> </span><span class="kw">update</span>(m.slopes, 
                   . <span class="op">~</span><span class="st"> </span>. <span class="op">+</span><span class="st"> </span>mass.fem.log10<span class="op">*</span>diet)</code></pre></div>
</div>
<div id="diffrent-slopes-for-each-order-x-biome" class="section level3">
<h3 class="hasAnchor">
<a href="#diffrent-slopes-for-each-order-x-biome" class="anchor"></a>Diffrent slopes for each order x biome</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m.slopes.x.biome &lt;-<span class="st"> </span><span class="kw">update</span>(m.slopes, 
                   . <span class="op">~</span><span class="st"> </span>. <span class="op">+</span><span class="st"> </span>mass.fem.log10<span class="op">*</span>biome)</code></pre></div>
</div>
</div>
<div id="compare-models" class="section level2">
<h2 class="hasAnchor">
<a href="#compare-models" class="anchor"></a>Compare models</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ICtab</span>(m.null,
      m.diet,
       m.mass,
       m.slopes,
       m.slopes.diet,
       m.slopes.x.diet,
      m.slopes.x.biome,
       <span class="dt">type =</span><span class="st">"AICc"</span>,
       <span class="dt">base =</span> T,
       <span class="dt">logLik =</span> T,
       <span class="dt">weights =</span> T)
<span class="co">#&gt;                  logLik AICc dLogLik dAICc df weight</span>
<span class="co">#&gt; m.slopes         -1.2   17.3  5.3     0.0  7  0.5409</span>
<span class="co">#&gt; m.null           -4.1   18.7  2.3     1.4  5  0.2649</span>
<span class="co">#&gt; m.diet           -2.9   20.7  3.5     3.4  7  0.0975</span>
<span class="co">#&gt; m.slopes.diet    -0.9   21.4  5.5     4.1  9  0.0699</span>
<span class="co">#&gt; m.slopes.x.biome -1.0   24.1  5.4     6.8  10 0.0182</span>
<span class="co">#&gt; m.mass           -6.4   25.6  0.0     8.3  6  0.0087</span>
<span class="co">#&gt; m.slopes.x.diet  -5.3   37.5  1.1    20.2  12 &lt;0.001</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#preliminaries">Preliminaries</a></li>
      <li><a href="#build-model">Build model</a></li>
      <li><a href="#compare-models">Compare models</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by First Last.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
